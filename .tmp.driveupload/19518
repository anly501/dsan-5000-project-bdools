{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# **Data Cleaning**"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Loading in FDA Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import json\n",
    "import tqdm\n",
    "%load_ext rpy2.ipython"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "### Adapted from https://www.kaggle.com/code/clwilliam/exploratory-notebook-a-first-look\n",
    "\n",
    "## Reading and processing my JSON files\n",
    "\n",
    "# Device 510k\n",
    "file_510k = open('/Users/dsan/My Drive/5000-Project/Data/Raw-data/FDA/510k.json','r')\n",
    "str_510k = file_510k.read()\n",
    "json_510k = json.loads(str_510k)\n",
    "df_510k = pd.json_normalize(json_510k,'results')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Initial Exploration + Cleaning of FDA Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 166594 entries, 0 to 166593\n",
      "Data columns (total 29 columns):\n",
      " #   Column                                 Non-Null Count   Dtype \n",
      "---  ------                                 --------------   ----- \n",
      " 0   third_party_flag                       166594 non-null  object\n",
      " 1   city                                   166594 non-null  object\n",
      " 2   advisory_committee_description         166594 non-null  object\n",
      " 3   address_1                              166594 non-null  object\n",
      " 4   address_2                              166594 non-null  object\n",
      " 5   statement_or_summary                   166594 non-null  object\n",
      " 6   product_code                           166594 non-null  object\n",
      " 7   zip_code                               166594 non-null  object\n",
      " 8   applicant                              166594 non-null  object\n",
      " 9   decision_date                          166594 non-null  object\n",
      " 10  decision_code                          166594 non-null  object\n",
      " 11  country_code                           166594 non-null  object\n",
      " 12  device_name                            166594 non-null  object\n",
      " 13  advisory_committee                     166594 non-null  object\n",
      " 14  contact                                166594 non-null  object\n",
      " 15  expedited_review_flag                  166594 non-null  object\n",
      " 16  k_number                               166594 non-null  object\n",
      " 17  state                                  166594 non-null  object\n",
      " 18  date_received                          166594 non-null  object\n",
      " 19  review_advisory_committee              166594 non-null  object\n",
      " 20  postal_code                            166594 non-null  object\n",
      " 21  decision_description                   166594 non-null  object\n",
      " 22  clearance_type                         166594 non-null  object\n",
      " 23  openfda.registration_number            163690 non-null  object\n",
      " 24  openfda.fei_number                     163690 non-null  object\n",
      " 25  openfda.device_name                    164962 non-null  object\n",
      " 26  openfda.medical_specialty_description  164962 non-null  object\n",
      " 27  openfda.regulation_number              164962 non-null  object\n",
      " 28  openfda.device_class                   164962 non-null  object\n",
      "dtypes: object(29)\n",
      "memory usage: 36.9+ MB\n",
      "None\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>third_party_flag</th>\n",
       "      <th>city</th>\n",
       "      <th>advisory_committee_description</th>\n",
       "      <th>address_1</th>\n",
       "      <th>address_2</th>\n",
       "      <th>statement_or_summary</th>\n",
       "      <th>product_code</th>\n",
       "      <th>zip_code</th>\n",
       "      <th>applicant</th>\n",
       "      <th>decision_date</th>\n",
       "      <th>...</th>\n",
       "      <th>review_advisory_committee</th>\n",
       "      <th>postal_code</th>\n",
       "      <th>decision_description</th>\n",
       "      <th>clearance_type</th>\n",
       "      <th>openfda.registration_number</th>\n",
       "      <th>openfda.fei_number</th>\n",
       "      <th>openfda.device_name</th>\n",
       "      <th>openfda.medical_specialty_description</th>\n",
       "      <th>openfda.regulation_number</th>\n",
       "      <th>openfda.device_class</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>N</td>\n",
       "      <td>CHATSWORTH</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>9530 DESOTO AVE.</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>91311</td>\n",
       "      <td>DEVON INDUSTRIES, INC.</td>\n",
       "      <td>1987-04-10</td>\n",
       "      <td>...</td>\n",
       "      <td>SU</td>\n",
       "      <td>91311</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Traditional</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>N</td>\n",
       "      <td>BRONX</td>\n",
       "      <td>General, Plastic Surgery</td>\n",
       "      <td>3830 BOSTON RD.</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>LRO</td>\n",
       "      <td>10475</td>\n",
       "      <td>FRAASS SURVIVAL SYSTEMS, INC.</td>\n",
       "      <td>1987-07-09</td>\n",
       "      <td>...</td>\n",
       "      <td>SU</td>\n",
       "      <td>10475</td>\n",
       "      <td>Substantially Equivalent</td>\n",
       "      <td>Traditional</td>\n",
       "      <td>[2320762, 1823410, 3011389083, 8022032, 293648...</td>\n",
       "      <td>[1823410, 3011389083, 2936485, 3013298431, 300...</td>\n",
       "      <td>General Surgery Tray</td>\n",
       "      <td>General, Plastic Surgery</td>\n",
       "      <td>878.4370</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>N</td>\n",
       "      <td>WILMINGTON</td>\n",
       "      <td>Anesthesiology</td>\n",
       "      <td>42 INDUSTRIAL WAY</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>BYD</td>\n",
       "      <td>01887</td>\n",
       "      <td>PORTEX, INC.</td>\n",
       "      <td>1988-01-19</td>\n",
       "      <td>...</td>\n",
       "      <td>AN</td>\n",
       "      <td>01887</td>\n",
       "      <td>Substantially Equivalent</td>\n",
       "      <td>Traditional</td>\n",
       "      <td>[3003902312, 3006534321, 8010485, 3006061749, ...</td>\n",
       "      <td>[3003902312, 3006534321, 3006061749, 301198796...</td>\n",
       "      <td>Condenser, Heat And Moisture (Artificial Nose)</td>\n",
       "      <td>Anesthesiology</td>\n",
       "      <td>868.5375</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>N</td>\n",
       "      <td>ST. LOUIS</td>\n",
       "      <td>General, Plastic Surgery</td>\n",
       "      <td>P.O. BOX 466</td>\n",
       "      <td></td>\n",
       "      <td>Summary</td>\n",
       "      <td>KKX</td>\n",
       "      <td>63166</td>\n",
       "      <td>ANGELICA UNIFORM</td>\n",
       "      <td>1995-01-02</td>\n",
       "      <td>...</td>\n",
       "      <td>HO</td>\n",
       "      <td>63166</td>\n",
       "      <td>Substantially Equivalent</td>\n",
       "      <td>Traditional</td>\n",
       "      <td>[2320762, 3007886583, 3006787036, 1032347, 300...</td>\n",
       "      <td>[3007886583, 3006787036, 1032347, 3004133257, ...</td>\n",
       "      <td>Drape, Surgical</td>\n",
       "      <td>General, Plastic Surgery</td>\n",
       "      <td>878.4370</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>N</td>\n",
       "      <td>BURLINGTON</td>\n",
       "      <td>Cardiovascular</td>\n",
       "      <td>32 SECOND AVE.</td>\n",
       "      <td></td>\n",
       "      <td>Statement</td>\n",
       "      <td>MKJ</td>\n",
       "      <td>01803</td>\n",
       "      <td>ZOLL MEDICAL CORP.</td>\n",
       "      <td>1993-10-07</td>\n",
       "      <td>...</td>\n",
       "      <td>CV</td>\n",
       "      <td>01803</td>\n",
       "      <td>Substantially Equivalent</td>\n",
       "      <td>Traditional</td>\n",
       "      <td>[1219103, 3002714378, 3013153405, 3012636179, ...</td>\n",
       "      <td>[3002714378, 3013153405, 6736, 3012636179, 300...</td>\n",
       "      <td>Automated External Defibrillators (Non-Wearable)</td>\n",
       "      <td>Cardiovascular</td>\n",
       "      <td>870.5310</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 29 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "  third_party_flag        city advisory_committee_description  \\\n",
       "0                N  CHATSWORTH                        Unknown   \n",
       "1                N       BRONX       General, Plastic Surgery   \n",
       "2                N  WILMINGTON                 Anesthesiology   \n",
       "3                N   ST. LOUIS       General, Plastic Surgery   \n",
       "4                N  BURLINGTON                 Cardiovascular   \n",
       "\n",
       "           address_1 address_2 statement_or_summary product_code zip_code  \\\n",
       "0   9530 DESOTO AVE.                                                91311   \n",
       "1    3830 BOSTON RD.                                         LRO    10475   \n",
       "2  42 INDUSTRIAL WAY                                         BYD    01887   \n",
       "3       P.O. BOX 466                        Summary          KKX    63166   \n",
       "4     32 SECOND AVE.                      Statement          MKJ    01803   \n",
       "\n",
       "                       applicant decision_date  ... review_advisory_committee  \\\n",
       "0         DEVON INDUSTRIES, INC.    1987-04-10  ...                        SU   \n",
       "1  FRAASS SURVIVAL SYSTEMS, INC.    1987-07-09  ...                        SU   \n",
       "2                   PORTEX, INC.    1988-01-19  ...                        AN   \n",
       "3               ANGELICA UNIFORM    1995-01-02  ...                        HO   \n",
       "4             ZOLL MEDICAL CORP.    1993-10-07  ...                        CV   \n",
       "\n",
       "  postal_code      decision_description clearance_type  \\\n",
       "0       91311                   Unknown    Traditional   \n",
       "1       10475  Substantially Equivalent    Traditional   \n",
       "2       01887  Substantially Equivalent    Traditional   \n",
       "3       63166  Substantially Equivalent    Traditional   \n",
       "4       01803  Substantially Equivalent    Traditional   \n",
       "\n",
       "                         openfda.registration_number  \\\n",
       "0                                                NaN   \n",
       "1  [2320762, 1823410, 3011389083, 8022032, 293648...   \n",
       "2  [3003902312, 3006534321, 8010485, 3006061749, ...   \n",
       "3  [2320762, 3007886583, 3006787036, 1032347, 300...   \n",
       "4  [1219103, 3002714378, 3013153405, 3012636179, ...   \n",
       "\n",
       "                                  openfda.fei_number  \\\n",
       "0                                                NaN   \n",
       "1  [1823410, 3011389083, 2936485, 3013298431, 300...   \n",
       "2  [3003902312, 3006534321, 3006061749, 301198796...   \n",
       "3  [3007886583, 3006787036, 1032347, 3004133257, ...   \n",
       "4  [3002714378, 3013153405, 6736, 3012636179, 300...   \n",
       "\n",
       "                                openfda.device_name  \\\n",
       "0                                               NaN   \n",
       "1                              General Surgery Tray   \n",
       "2    Condenser, Heat And Moisture (Artificial Nose)   \n",
       "3                                   Drape, Surgical   \n",
       "4  Automated External Defibrillators (Non-Wearable)   \n",
       "\n",
       "  openfda.medical_specialty_description openfda.regulation_number  \\\n",
       "0                                   NaN                       NaN   \n",
       "1              General, Plastic Surgery                  878.4370   \n",
       "2                        Anesthesiology                  868.5375   \n",
       "3              General, Plastic Surgery                  878.4370   \n",
       "4                        Cardiovascular                  870.5310   \n",
       "\n",
       "  openfda.device_class  \n",
       "0                  NaN  \n",
       "1                    2  \n",
       "2                    1  \n",
       "3                    2  \n",
       "4                    3  \n",
       "\n",
       "[5 rows x 29 columns]"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "print(df_510k.info())\n",
    "df_510k.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                                  openfda.device_name  count\n",
      "0                   Powered Laser Surgical Instrument   2659\n",
      "1   Electrosurgical, Cutting & Coagulation & Acces...   2141\n",
      "2              System, Image Processing, Radiological   2117\n",
      "3                     Latex Patient Examination Glove   1952\n",
      "4                      Implant, Endosseous, Root-Form   1450\n",
      "5           Hearing Aid, Air-Conduction, Prescription   1366\n",
      "6              Laparoscope, General & Plastic Surgery   1349\n",
      "7                               Plate, Fixation, Bone   1164\n",
      "8                  Set, Administration, Intravascular   1153\n",
      "9   System, Measurement, Blood-Pressure, Non-Invasive   1139\n",
      "10                  Polymer Patient Examination Glove   1097\n",
      "11         System, Nuclear Magnetic Resonance Imaging   1025\n",
      "12        System, Imaging, Pulsed Doppler, Ultrasonic   1018\n",
      "13                              Screw, Fixation, Bone   1014\n",
      "14                       Material, Tooth Shade, Resin    882\n",
      "15           System, Imaging, Pulsed Echo, Ultrasonic    866\n",
      "16  Prosthesis, Knee, Patellofemorotibial, Semi-Co...    865\n",
      "17                             Catheter, Percutaneous    845\n",
      "18                                     Pump, Infusion    832\n",
      "19  Intervertebral Fusion Device With Bone Graft, ...    806\n"
     ]
    }
   ],
   "source": [
    "print(df_510k[\"openfda.device_name\"].value_counts().reset_index().head(20))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Merging with SEC Financial Data"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Extract Company Names from SEC Filings"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 17415/17415 [17:34<00:00, 16.52it/s]  \n"
     ]
    }
   ],
   "source": [
    "import glob\n",
    "\n",
    "filenames = glob.glob('/Users/dsan/My Drive/5000-Project/Data/Raw-data/SEC/companyfacts/*.json')\n",
    "\n",
    "sec_list = []\n",
    "for file in tqdm.tqdm(filenames):\n",
    "    with open(file, 'r') as f:\n",
    "        try:\n",
    "            data = json.load(f)\n",
    "            name = data[\"entityName\"]\n",
    "            cik = data[\"cik\"]\n",
    "            row = {\"CIK\": cik, \"SEC_name\": name}\n",
    "            sec_list.append(row)\n",
    "        except:\n",
    "            continue"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>CIK</th>\n",
       "      <th>SEC_name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>743870</td>\n",
       "      <td>RANCON REALTY FUND IV</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>815097</td>\n",
       "      <td>Carnival Corporation</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1466739</td>\n",
       "      <td>NEXT GALAXY CORP.</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1841661</td>\n",
       "      <td>AF ACQUISITION CORP.</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0001831099</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17339</th>\n",
       "      <td>899749</td>\n",
       "      <td>HEALTHCARE REALTY TRUST INCORPORATED</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17340</th>\n",
       "      <td>1524083</td>\n",
       "      <td>CHATCHING INC.</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17341</th>\n",
       "      <td>1381668</td>\n",
       "      <td>TFS FINANCIAL CORPORATION</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17342</th>\n",
       "      <td>1354772</td>\n",
       "      <td>NORTHEAST COMMUNITY BANCORP INC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17343</th>\n",
       "      <td>0001873441</td>\n",
       "      <td>BLOCKCHAIN COINVESTORS ACQUISITION CORP. I</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>17344 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "              CIK                                    SEC_name\n",
       "0          743870                       RANCON REALTY FUND IV\n",
       "1          815097                        Carnival Corporation\n",
       "2         1466739                           NEXT GALAXY CORP.\n",
       "3         1841661                        AF ACQUISITION CORP.\n",
       "4      0001831099                                            \n",
       "...           ...                                         ...\n",
       "17339      899749        HEALTHCARE REALTY TRUST INCORPORATED\n",
       "17340     1524083                              CHATCHING INC.\n",
       "17341     1381668                   TFS FINANCIAL CORPORATION\n",
       "17342     1354772             NORTHEAST COMMUNITY BANCORP INC\n",
       "17343  0001873441  BLOCKCHAIN COINVESTORS ACQUISITION CORP. I\n",
       "\n",
       "[17344 rows x 2 columns]"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Creating SEC dataframe\n",
    "df_sec = pd.DataFrame(sec_list)\n",
    "df_sec"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [],
   "source": [
    "## filter df_510k for companies that are in the SEC dataframe and combining\n",
    "df_matches = df_510k[df_510k[\"applicant\"].isin(df_sec[\"SEC_name\"])]                 # filter df_510k  \n",
    "df_matches = df_matches.merge(df_sec, left_on=\"applicant\", right_on=\"SEC_name\")     # merge the two dataframes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>third_party_flag</th>\n",
       "      <th>city</th>\n",
       "      <th>advisory_committee_description</th>\n",
       "      <th>address_1</th>\n",
       "      <th>address_2</th>\n",
       "      <th>statement_or_summary</th>\n",
       "      <th>product_code</th>\n",
       "      <th>zip_code</th>\n",
       "      <th>applicant</th>\n",
       "      <th>decision_date</th>\n",
       "      <th>...</th>\n",
       "      <th>decision_description</th>\n",
       "      <th>clearance_type</th>\n",
       "      <th>openfda.registration_number</th>\n",
       "      <th>openfda.fei_number</th>\n",
       "      <th>openfda.device_name</th>\n",
       "      <th>openfda.medical_specialty_description</th>\n",
       "      <th>openfda.regulation_number</th>\n",
       "      <th>openfda.device_class</th>\n",
       "      <th>CIK</th>\n",
       "      <th>SEC_name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>N</td>\n",
       "      <td>PHOENIXVILLE</td>\n",
       "      <td>Orthopedic</td>\n",
       "      <td>303 SCHELL LANE</td>\n",
       "      <td></td>\n",
       "      <td>Summary</td>\n",
       "      <td>MQP</td>\n",
       "      <td>19460</td>\n",
       "      <td>GLOBUS MEDICAL, INC.</td>\n",
       "      <td>2004-03-23</td>\n",
       "      <td>...</td>\n",
       "      <td>Substantially Equivalent</td>\n",
       "      <td>Special</td>\n",
       "      <td>[3003761012, 3010032903, 9617544, 3009941480, ...</td>\n",
       "      <td>[3003761012, 3010032903, 3009941480, 301586949...</td>\n",
       "      <td>Spinal Vertebral Body Replacement Device</td>\n",
       "      <td>Orthopedic</td>\n",
       "      <td>888.3060</td>\n",
       "      <td>2</td>\n",
       "      <td>1237831</td>\n",
       "      <td>GLOBUS MEDICAL, INC.</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>N</td>\n",
       "      <td>PHOENIXVILLE</td>\n",
       "      <td>Orthopedic</td>\n",
       "      <td>303 SCHELL LANE</td>\n",
       "      <td></td>\n",
       "      <td>Summary</td>\n",
       "      <td>KWQ</td>\n",
       "      <td>19460</td>\n",
       "      <td>GLOBUS MEDICAL, INC.</td>\n",
       "      <td>2004-06-17</td>\n",
       "      <td>...</td>\n",
       "      <td>Substantially Equivalent</td>\n",
       "      <td>Traditional</td>\n",
       "      <td>[9617544, 3009888740, 3005677016, 3011277306, ...</td>\n",
       "      <td>[3009888740, 3003018882, 3010938185, 300567701...</td>\n",
       "      <td>Appliance, Fixation, Spinal Intervertebral Body</td>\n",
       "      <td>Orthopedic</td>\n",
       "      <td>888.3060</td>\n",
       "      <td>2</td>\n",
       "      <td>1237831</td>\n",
       "      <td>GLOBUS MEDICAL, INC.</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>N</td>\n",
       "      <td>AUDUBON</td>\n",
       "      <td>Orthopedic</td>\n",
       "      <td>2560 GENERAL ARMISTEAD AVE.</td>\n",
       "      <td>VALLEY FORGE BUSINESS CENTER</td>\n",
       "      <td>Summary</td>\n",
       "      <td>KWQ</td>\n",
       "      <td>19403</td>\n",
       "      <td>GLOBUS MEDICAL, INC.</td>\n",
       "      <td>2009-08-13</td>\n",
       "      <td>...</td>\n",
       "      <td>Substantially Equivalent</td>\n",
       "      <td>Special</td>\n",
       "      <td>[9617544, 3009888740, 3005677016, 3011277306, ...</td>\n",
       "      <td>[3009888740, 3003018882, 3010938185, 300567701...</td>\n",
       "      <td>Appliance, Fixation, Spinal Intervertebral Body</td>\n",
       "      <td>Orthopedic</td>\n",
       "      <td>888.3060</td>\n",
       "      <td>2</td>\n",
       "      <td>1237831</td>\n",
       "      <td>GLOBUS MEDICAL, INC.</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>N</td>\n",
       "      <td>AUDUBON</td>\n",
       "      <td>Orthopedic</td>\n",
       "      <td>2560 General Armistead Ave</td>\n",
       "      <td>VALLEY FORGE BUSINESS CENTER</td>\n",
       "      <td>Summary</td>\n",
       "      <td>MQV</td>\n",
       "      <td>19403</td>\n",
       "      <td>GLOBUS MEDICAL, INC.</td>\n",
       "      <td>2014-08-26</td>\n",
       "      <td>...</td>\n",
       "      <td>Substantially Equivalent</td>\n",
       "      <td>Traditional</td>\n",
       "      <td>[2030598, 3009595577, 3005581234, 1000577893, ...</td>\n",
       "      <td>[3009595577, 3002807305, 1000577893, 300558123...</td>\n",
       "      <td>Filler, Bone Void, Calcium Compound</td>\n",
       "      <td>Orthopedic</td>\n",
       "      <td>888.3045</td>\n",
       "      <td>2</td>\n",
       "      <td>1237831</td>\n",
       "      <td>GLOBUS MEDICAL, INC.</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>N</td>\n",
       "      <td>PHOENIXVILLE</td>\n",
       "      <td>Orthopedic</td>\n",
       "      <td>303 SCHELL LANE</td>\n",
       "      <td></td>\n",
       "      <td>Summary</td>\n",
       "      <td>MNH</td>\n",
       "      <td>19460</td>\n",
       "      <td>GLOBUS MEDICAL, INC.</td>\n",
       "      <td>2004-05-20</td>\n",
       "      <td>...</td>\n",
       "      <td>Substantially Equivalent</td>\n",
       "      <td>Traditional</td>\n",
       "      <td>[3009149199, 9617544, 3003697998, 3009888740, ...</td>\n",
       "      <td>[3009149199, 3003697998, 3009888740, 300301888...</td>\n",
       "      <td>Orthosis, Spondylolisthesis Spinal Fixation</td>\n",
       "      <td>Orthopedic</td>\n",
       "      <td>888.3070</td>\n",
       "      <td>2</td>\n",
       "      <td>1237831</td>\n",
       "      <td>GLOBUS MEDICAL, INC.</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2172</th>\n",
       "      <td>N</td>\n",
       "      <td>Suwanee</td>\n",
       "      <td>Obstetrics/Gynecology</td>\n",
       "      <td>3950 Johns Creek CT.</td>\n",
       "      <td></td>\n",
       "      <td>Summary</td>\n",
       "      <td>MQF</td>\n",
       "      <td>30024</td>\n",
       "      <td>Femasys Inc.</td>\n",
       "      <td>2023-09-22</td>\n",
       "      <td>...</td>\n",
       "      <td>Substantially Equivalent</td>\n",
       "      <td>Traditional</td>\n",
       "      <td>[1216677, 3014755376, 3005941719, 1018470, 301...</td>\n",
       "      <td>[3002807969, 3014755376, 1216677, 3014295858, ...</td>\n",
       "      <td>Catheter, Assisted Reproduction</td>\n",
       "      <td>Obstetrics/Gynecology</td>\n",
       "      <td>884.6110</td>\n",
       "      <td>2</td>\n",
       "      <td>1339005</td>\n",
       "      <td>Femasys Inc.</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2173</th>\n",
       "      <td>N</td>\n",
       "      <td>San Jose</td>\n",
       "      <td>General, Plastic Surgery</td>\n",
       "      <td>1800 Bering Drive</td>\n",
       "      <td></td>\n",
       "      <td>Summary</td>\n",
       "      <td>ONF</td>\n",
       "      <td>95112</td>\n",
       "      <td>Venus Concept Inc.</td>\n",
       "      <td>2023-09-11</td>\n",
       "      <td>...</td>\n",
       "      <td>Substantially Equivalent</td>\n",
       "      <td>Special</td>\n",
       "      <td>[3007085226, 3017905264, 3016170453, 300998260...</td>\n",
       "      <td>[3007085226, 3017905264, 3016170453, 300998260...</td>\n",
       "      <td>Powered Light Based Non-Laser Surgical Instrum...</td>\n",
       "      <td>General, Plastic Surgery</td>\n",
       "      <td>878.4810</td>\n",
       "      <td>2</td>\n",
       "      <td>1409269</td>\n",
       "      <td>Venus Concept Inc.</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2174</th>\n",
       "      <td>N</td>\n",
       "      <td>WARSAW</td>\n",
       "      <td>Orthopedic</td>\n",
       "      <td>56 E BELL DR</td>\n",
       "      <td></td>\n",
       "      <td>Summary</td>\n",
       "      <td>HRS</td>\n",
       "      <td>46582</td>\n",
       "      <td>BIOMET INC</td>\n",
       "      <td>2016-10-12</td>\n",
       "      <td>...</td>\n",
       "      <td>Substantially Equivalent</td>\n",
       "      <td>Traditional</td>\n",
       "      <td>[3007441485, 1032347, 3009888740, 3008951116, ...</td>\n",
       "      <td>[3007441485, 3003051987, 1032347, 3009888740, ...</td>\n",
       "      <td>Plate, Fixation, Bone</td>\n",
       "      <td>Orthopedic</td>\n",
       "      <td>888.3030</td>\n",
       "      <td>2</td>\n",
       "      <td>351346</td>\n",
       "      <td>BIOMET INC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2175</th>\n",
       "      <td>N</td>\n",
       "      <td>North Chicago</td>\n",
       "      <td>Gastroenterology, Urology</td>\n",
       "      <td>1 N. Waukegan Road</td>\n",
       "      <td></td>\n",
       "      <td>Summary</td>\n",
       "      <td>KNT</td>\n",
       "      <td>60064</td>\n",
       "      <td>AbbVie Inc.</td>\n",
       "      <td>2015-01-14</td>\n",
       "      <td>...</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Traditional</td>\n",
       "      <td>[3004194523, 3009247326, 2030598, 3013508647, ...</td>\n",
       "      <td>[3003172243, 3004194523, 3009247326, 301350864...</td>\n",
       "      <td>Tubes, Gastrointestinal (And Accessories)</td>\n",
       "      <td>Gastroenterology, Urology</td>\n",
       "      <td>876.5980</td>\n",
       "      <td>2</td>\n",
       "      <td>1551152</td>\n",
       "      <td>AbbVie Inc.</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2176</th>\n",
       "      <td>N</td>\n",
       "      <td>SUNNYVALE</td>\n",
       "      <td>Cardiovascular</td>\n",
       "      <td>735 NORTH PASTORIA AVENUE</td>\n",
       "      <td></td>\n",
       "      <td>Summary</td>\n",
       "      <td>NTE</td>\n",
       "      <td>94085</td>\n",
       "      <td>SILK ROAD MEDICAL, INC.</td>\n",
       "      <td>2016-03-10</td>\n",
       "      <td>...</td>\n",
       "      <td>Substantially Equivalent</td>\n",
       "      <td>Traditional</td>\n",
       "      <td>[3004742232, 2030598, 3013510102, 2939561, 212...</td>\n",
       "      <td>[3004742232, 3013510102, 2126666, 2024024, 300...</td>\n",
       "      <td>Temporary Carotid Catheter For Embolic Capture</td>\n",
       "      <td>Cardiovascular</td>\n",
       "      <td>870.1250</td>\n",
       "      <td>2</td>\n",
       "      <td>1397702</td>\n",
       "      <td>SILK ROAD MEDICAL, INC.</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2177 rows × 31 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     third_party_flag           city advisory_committee_description  \\\n",
       "0                   N   PHOENIXVILLE                     Orthopedic   \n",
       "1                   N   PHOENIXVILLE                     Orthopedic   \n",
       "2                   N        AUDUBON                     Orthopedic   \n",
       "3                   N        AUDUBON                     Orthopedic   \n",
       "4                   N   PHOENIXVILLE                     Orthopedic   \n",
       "...               ...            ...                            ...   \n",
       "2172                N        Suwanee          Obstetrics/Gynecology   \n",
       "2173                N       San Jose       General, Plastic Surgery   \n",
       "2174                N         WARSAW                     Orthopedic   \n",
       "2175                N  North Chicago      Gastroenterology, Urology   \n",
       "2176                N      SUNNYVALE                 Cardiovascular   \n",
       "\n",
       "                        address_1                     address_2  \\\n",
       "0                 303 SCHELL LANE                                 \n",
       "1                 303 SCHELL LANE                                 \n",
       "2     2560 GENERAL ARMISTEAD AVE.  VALLEY FORGE BUSINESS CENTER   \n",
       "3      2560 General Armistead Ave  VALLEY FORGE BUSINESS CENTER   \n",
       "4                 303 SCHELL LANE                                 \n",
       "...                           ...                           ...   \n",
       "2172         3950 Johns Creek CT.                                 \n",
       "2173            1800 Bering Drive                                 \n",
       "2174                 56 E BELL DR                                 \n",
       "2175           1 N. Waukegan Road                                 \n",
       "2176    735 NORTH PASTORIA AVENUE                                 \n",
       "\n",
       "     statement_or_summary product_code zip_code                applicant  \\\n",
       "0                 Summary          MQP    19460     GLOBUS MEDICAL, INC.   \n",
       "1                 Summary          KWQ    19460     GLOBUS MEDICAL, INC.   \n",
       "2                 Summary          KWQ    19403     GLOBUS MEDICAL, INC.   \n",
       "3                 Summary          MQV    19403     GLOBUS MEDICAL, INC.   \n",
       "4                 Summary          MNH    19460     GLOBUS MEDICAL, INC.   \n",
       "...                   ...          ...      ...                      ...   \n",
       "2172              Summary          MQF    30024             Femasys Inc.   \n",
       "2173              Summary          ONF    95112       Venus Concept Inc.   \n",
       "2174              Summary          HRS    46582               BIOMET INC   \n",
       "2175              Summary          KNT    60064              AbbVie Inc.   \n",
       "2176              Summary          NTE    94085  SILK ROAD MEDICAL, INC.   \n",
       "\n",
       "     decision_date  ...      decision_description clearance_type  \\\n",
       "0       2004-03-23  ...  Substantially Equivalent        Special   \n",
       "1       2004-06-17  ...  Substantially Equivalent    Traditional   \n",
       "2       2009-08-13  ...  Substantially Equivalent        Special   \n",
       "3       2014-08-26  ...  Substantially Equivalent    Traditional   \n",
       "4       2004-05-20  ...  Substantially Equivalent    Traditional   \n",
       "...            ...  ...                       ...            ...   \n",
       "2172    2023-09-22  ...  Substantially Equivalent    Traditional   \n",
       "2173    2023-09-11  ...  Substantially Equivalent        Special   \n",
       "2174    2016-10-12  ...  Substantially Equivalent    Traditional   \n",
       "2175    2015-01-14  ...                   Unknown    Traditional   \n",
       "2176    2016-03-10  ...  Substantially Equivalent    Traditional   \n",
       "\n",
       "                            openfda.registration_number  \\\n",
       "0     [3003761012, 3010032903, 9617544, 3009941480, ...   \n",
       "1     [9617544, 3009888740, 3005677016, 3011277306, ...   \n",
       "2     [9617544, 3009888740, 3005677016, 3011277306, ...   \n",
       "3     [2030598, 3009595577, 3005581234, 1000577893, ...   \n",
       "4     [3009149199, 9617544, 3003697998, 3009888740, ...   \n",
       "...                                                 ...   \n",
       "2172  [1216677, 3014755376, 3005941719, 1018470, 301...   \n",
       "2173  [3007085226, 3017905264, 3016170453, 300998260...   \n",
       "2174  [3007441485, 1032347, 3009888740, 3008951116, ...   \n",
       "2175  [3004194523, 3009247326, 2030598, 3013508647, ...   \n",
       "2176  [3004742232, 2030598, 3013510102, 2939561, 212...   \n",
       "\n",
       "                                     openfda.fei_number  \\\n",
       "0     [3003761012, 3010032903, 3009941480, 301586949...   \n",
       "1     [3009888740, 3003018882, 3010938185, 300567701...   \n",
       "2     [3009888740, 3003018882, 3010938185, 300567701...   \n",
       "3     [3009595577, 3002807305, 1000577893, 300558123...   \n",
       "4     [3009149199, 3003697998, 3009888740, 300301888...   \n",
       "...                                                 ...   \n",
       "2172  [3002807969, 3014755376, 1216677, 3014295858, ...   \n",
       "2173  [3007085226, 3017905264, 3016170453, 300998260...   \n",
       "2174  [3007441485, 3003051987, 1032347, 3009888740, ...   \n",
       "2175  [3003172243, 3004194523, 3009247326, 301350864...   \n",
       "2176  [3004742232, 3013510102, 2126666, 2024024, 300...   \n",
       "\n",
       "                                    openfda.device_name  \\\n",
       "0              Spinal Vertebral Body Replacement Device   \n",
       "1       Appliance, Fixation, Spinal Intervertebral Body   \n",
       "2       Appliance, Fixation, Spinal Intervertebral Body   \n",
       "3                   Filler, Bone Void, Calcium Compound   \n",
       "4           Orthosis, Spondylolisthesis Spinal Fixation   \n",
       "...                                                 ...   \n",
       "2172                    Catheter, Assisted Reproduction   \n",
       "2173  Powered Light Based Non-Laser Surgical Instrum...   \n",
       "2174                              Plate, Fixation, Bone   \n",
       "2175          Tubes, Gastrointestinal (And Accessories)   \n",
       "2176     Temporary Carotid Catheter For Embolic Capture   \n",
       "\n",
       "     openfda.medical_specialty_description openfda.regulation_number  \\\n",
       "0                               Orthopedic                  888.3060   \n",
       "1                               Orthopedic                  888.3060   \n",
       "2                               Orthopedic                  888.3060   \n",
       "3                               Orthopedic                  888.3045   \n",
       "4                               Orthopedic                  888.3070   \n",
       "...                                    ...                       ...   \n",
       "2172                 Obstetrics/Gynecology                  884.6110   \n",
       "2173              General, Plastic Surgery                  878.4810   \n",
       "2174                            Orthopedic                  888.3030   \n",
       "2175             Gastroenterology, Urology                  876.5980   \n",
       "2176                        Cardiovascular                  870.1250   \n",
       "\n",
       "     openfda.device_class      CIK                 SEC_name  \n",
       "0                       2  1237831     GLOBUS MEDICAL, INC.  \n",
       "1                       2  1237831     GLOBUS MEDICAL, INC.  \n",
       "2                       2  1237831     GLOBUS MEDICAL, INC.  \n",
       "3                       2  1237831     GLOBUS MEDICAL, INC.  \n",
       "4                       2  1237831     GLOBUS MEDICAL, INC.  \n",
       "...                   ...      ...                      ...  \n",
       "2172                    2  1339005             Femasys Inc.  \n",
       "2173                    2  1409269       Venus Concept Inc.  \n",
       "2174                    2   351346               BIOMET INC  \n",
       "2175                    2  1551152              AbbVie Inc.  \n",
       "2176                    2  1397702  SILK ROAD MEDICAL, INC.  \n",
       "\n",
       "[2177 rows x 31 columns]"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_matches"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>third_party_flag</th>\n",
       "      <th>city</th>\n",
       "      <th>advisory_committee_description</th>\n",
       "      <th>address_1</th>\n",
       "      <th>address_2</th>\n",
       "      <th>statement_or_summary</th>\n",
       "      <th>product_code</th>\n",
       "      <th>zip_code</th>\n",
       "      <th>applicant</th>\n",
       "      <th>decision_date</th>\n",
       "      <th>...</th>\n",
       "      <th>decision_description</th>\n",
       "      <th>clearance_type</th>\n",
       "      <th>openfda.registration_number</th>\n",
       "      <th>openfda.fei_number</th>\n",
       "      <th>openfda.device_name</th>\n",
       "      <th>openfda.medical_specialty_description</th>\n",
       "      <th>openfda.regulation_number</th>\n",
       "      <th>openfda.device_class</th>\n",
       "      <th>CIK</th>\n",
       "      <th>SEC_name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>N</td>\n",
       "      <td>AUDUBON</td>\n",
       "      <td>Orthopedic</td>\n",
       "      <td>2560 GENERAL ARMISTEAD AVE.</td>\n",
       "      <td></td>\n",
       "      <td>Summary</td>\n",
       "      <td>NDN</td>\n",
       "      <td>19403</td>\n",
       "      <td>GLOBUS MEDICAL, INC.</td>\n",
       "      <td>2017-01-23</td>\n",
       "      <td>...</td>\n",
       "      <td>Substantially Equivalent</td>\n",
       "      <td>Traditional</td>\n",
       "      <td>[2648666, 3010032903, 2648623, 3010173425, 202...</td>\n",
       "      <td>[2648666, 3010032903, 2648623, 3005677016, 224...</td>\n",
       "      <td>Cement, Bone, Vertebroplasty</td>\n",
       "      <td>Orthopedic</td>\n",
       "      <td>888.3027</td>\n",
       "      <td>2</td>\n",
       "      <td>1237831</td>\n",
       "      <td>GLOBUS MEDICAL, INC.</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>39</th>\n",
       "      <td>N</td>\n",
       "      <td>AUDUBON</td>\n",
       "      <td>Orthopedic</td>\n",
       "      <td>2560 GENERAL ARMISTEAD AVE.</td>\n",
       "      <td></td>\n",
       "      <td>Summary</td>\n",
       "      <td>HWC</td>\n",
       "      <td>19403</td>\n",
       "      <td>GLOBUS MEDICAL, INC.</td>\n",
       "      <td>2017-05-01</td>\n",
       "      <td>...</td>\n",
       "      <td>Substantially Equivalent</td>\n",
       "      <td>Traditional</td>\n",
       "      <td>[3007441485, 2648666, 3009149199, 9617544, 103...</td>\n",
       "      <td>[3007441485, 2648666, 3003051987, 3009149199, ...</td>\n",
       "      <td>Screw, Fixation, Bone</td>\n",
       "      <td>Orthopedic</td>\n",
       "      <td>888.3040</td>\n",
       "      <td>2</td>\n",
       "      <td>1237831</td>\n",
       "      <td>GLOBUS MEDICAL, INC.</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>44</th>\n",
       "      <td>N</td>\n",
       "      <td>Franklin Lakes</td>\n",
       "      <td>General Hospital</td>\n",
       "      <td>1 Becton Drive</td>\n",
       "      <td></td>\n",
       "      <td>Summary</td>\n",
       "      <td>FMF</td>\n",
       "      <td>07417</td>\n",
       "      <td>Becton, Dickinson and Company</td>\n",
       "      <td>2018-10-23</td>\n",
       "      <td>...</td>\n",
       "      <td>Substantially Equivalent</td>\n",
       "      <td>Traditional</td>\n",
       "      <td>[2648666, 9616066, 9617544, 3014314985, 804114...</td>\n",
       "      <td>[2648666, 3003166194, 3014314985, 3002974635, ...</td>\n",
       "      <td>Syringe, Piston</td>\n",
       "      <td>General Hospital</td>\n",
       "      <td>880.5860</td>\n",
       "      <td>2</td>\n",
       "      <td>10795</td>\n",
       "      <td>Becton, Dickinson and Company</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>47</th>\n",
       "      <td>N</td>\n",
       "      <td>Sparks</td>\n",
       "      <td>Microbiology</td>\n",
       "      <td>7 Loveton Circle</td>\n",
       "      <td></td>\n",
       "      <td>Summary</td>\n",
       "      <td>MDB</td>\n",
       "      <td>21152</td>\n",
       "      <td>Becton, Dickinson and Company</td>\n",
       "      <td>2023-03-24</td>\n",
       "      <td>...</td>\n",
       "      <td>Substantially Equivalent</td>\n",
       "      <td>Special</td>\n",
       "      <td>[3003542872, 3010392988, 3009220482, 1111096, ...</td>\n",
       "      <td>[3003542872, 3000215273, 3010392988, 1111096, ...</td>\n",
       "      <td>System, Blood Culturing</td>\n",
       "      <td>Microbiology</td>\n",
       "      <td>866.2560</td>\n",
       "      <td>1</td>\n",
       "      <td>10795</td>\n",
       "      <td>Becton, Dickinson and Company</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>48</th>\n",
       "      <td>N</td>\n",
       "      <td>Franklin Lakes</td>\n",
       "      <td>Clinical Chemistry</td>\n",
       "      <td>1 Becton Drive</td>\n",
       "      <td></td>\n",
       "      <td>Summary</td>\n",
       "      <td>JKA</td>\n",
       "      <td>07417</td>\n",
       "      <td>Becton, Dickinson and Company</td>\n",
       "      <td>2022-02-04</td>\n",
       "      <td>...</td>\n",
       "      <td>Substantially Equivalent</td>\n",
       "      <td>Traditional</td>\n",
       "      <td>[2320762, 1063851, 3009495876, 3015433750, 103...</td>\n",
       "      <td>[1000174591, 3009495876, 3015433750, 300297463...</td>\n",
       "      <td>Tubes, Vials, Systems, Serum Separators, Blood...</td>\n",
       "      <td>Clinical Chemistry</td>\n",
       "      <td>862.1675</td>\n",
       "      <td>2</td>\n",
       "      <td>10795</td>\n",
       "      <td>Becton, Dickinson and Company</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2166</th>\n",
       "      <td>N</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>Cardiovascular</td>\n",
       "      <td>One Penumbra Place</td>\n",
       "      <td></td>\n",
       "      <td>Summary</td>\n",
       "      <td>QEW</td>\n",
       "      <td>94502</td>\n",
       "      <td>Penumbra, Inc</td>\n",
       "      <td>2020-05-28</td>\n",
       "      <td>...</td>\n",
       "      <td>Substantially Equivalent</td>\n",
       "      <td>Traditional</td>\n",
       "      <td>[3026201252, 3015614177, 1222140, 3027696665, ...</td>\n",
       "      <td>[3002913962, 3000206435, 3026201252, 301561417...</td>\n",
       "      <td>Peripheral Mechanical Thrombectomy With Aspira...</td>\n",
       "      <td>Cardiovascular</td>\n",
       "      <td>870.5150</td>\n",
       "      <td>2</td>\n",
       "      <td>1321732</td>\n",
       "      <td>Penumbra, Inc</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2167</th>\n",
       "      <td>N</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>Cardiovascular</td>\n",
       "      <td>One Penumbra Place</td>\n",
       "      <td></td>\n",
       "      <td>Summary</td>\n",
       "      <td>QJP</td>\n",
       "      <td>95132</td>\n",
       "      <td>Penumbra, Inc</td>\n",
       "      <td>2022-11-04</td>\n",
       "      <td>...</td>\n",
       "      <td>Substantially Equivalent</td>\n",
       "      <td>Traditional</td>\n",
       "      <td>[3012497308, 3012543881, 2029214, 3006010712, ...</td>\n",
       "      <td>[3012497308, 3012543881, 3006010712, 1048735, ...</td>\n",
       "      <td>Catheter, Percutaneous, Neurovasculature</td>\n",
       "      <td>Cardiovascular</td>\n",
       "      <td>870.1250</td>\n",
       "      <td>2</td>\n",
       "      <td>1321732</td>\n",
       "      <td>Penumbra, Inc</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2169</th>\n",
       "      <td>N</td>\n",
       "      <td>San Francisco</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>1400 16th Street</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>QVU</td>\n",
       "      <td>94103</td>\n",
       "      <td>Invitae Corporation</td>\n",
       "      <td>2023-09-29</td>\n",
       "      <td>...</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Direct</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1501134</td>\n",
       "      <td>Invitae Corporation</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2172</th>\n",
       "      <td>N</td>\n",
       "      <td>Suwanee</td>\n",
       "      <td>Obstetrics/Gynecology</td>\n",
       "      <td>3950 Johns Creek CT.</td>\n",
       "      <td></td>\n",
       "      <td>Summary</td>\n",
       "      <td>MQF</td>\n",
       "      <td>30024</td>\n",
       "      <td>Femasys Inc.</td>\n",
       "      <td>2023-09-22</td>\n",
       "      <td>...</td>\n",
       "      <td>Substantially Equivalent</td>\n",
       "      <td>Traditional</td>\n",
       "      <td>[1216677, 3014755376, 3005941719, 1018470, 301...</td>\n",
       "      <td>[3002807969, 3014755376, 1216677, 3014295858, ...</td>\n",
       "      <td>Catheter, Assisted Reproduction</td>\n",
       "      <td>Obstetrics/Gynecology</td>\n",
       "      <td>884.6110</td>\n",
       "      <td>2</td>\n",
       "      <td>1339005</td>\n",
       "      <td>Femasys Inc.</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2173</th>\n",
       "      <td>N</td>\n",
       "      <td>San Jose</td>\n",
       "      <td>General, Plastic Surgery</td>\n",
       "      <td>1800 Bering Drive</td>\n",
       "      <td></td>\n",
       "      <td>Summary</td>\n",
       "      <td>ONF</td>\n",
       "      <td>95112</td>\n",
       "      <td>Venus Concept Inc.</td>\n",
       "      <td>2023-09-11</td>\n",
       "      <td>...</td>\n",
       "      <td>Substantially Equivalent</td>\n",
       "      <td>Special</td>\n",
       "      <td>[3007085226, 3017905264, 3016170453, 300998260...</td>\n",
       "      <td>[3007085226, 3017905264, 3016170453, 300998260...</td>\n",
       "      <td>Powered Light Based Non-Laser Surgical Instrum...</td>\n",
       "      <td>General, Plastic Surgery</td>\n",
       "      <td>878.4810</td>\n",
       "      <td>2</td>\n",
       "      <td>1409269</td>\n",
       "      <td>Venus Concept Inc.</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>304 rows × 31 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     third_party_flag            city advisory_committee_description  \\\n",
       "22                  N         AUDUBON                     Orthopedic   \n",
       "39                  N         AUDUBON                     Orthopedic   \n",
       "44                  N  Franklin Lakes               General Hospital   \n",
       "47                  N          Sparks                   Microbiology   \n",
       "48                  N  Franklin Lakes             Clinical Chemistry   \n",
       "...               ...             ...                            ...   \n",
       "2166                N         Alameda                 Cardiovascular   \n",
       "2167                N         Alameda                 Cardiovascular   \n",
       "2169                N   San Francisco                        Unknown   \n",
       "2172                N         Suwanee          Obstetrics/Gynecology   \n",
       "2173                N        San Jose       General, Plastic Surgery   \n",
       "\n",
       "                        address_1 address_2 statement_or_summary product_code  \\\n",
       "22    2560 GENERAL ARMISTEAD AVE.                        Summary          NDN   \n",
       "39    2560 GENERAL ARMISTEAD AVE.                        Summary          HWC   \n",
       "44                 1 Becton Drive                        Summary          FMF   \n",
       "47               7 Loveton Circle                        Summary          MDB   \n",
       "48                 1 Becton Drive                        Summary          JKA   \n",
       "...                           ...       ...                  ...          ...   \n",
       "2166           One Penumbra Place                        Summary          QEW   \n",
       "2167           One Penumbra Place                        Summary          QJP   \n",
       "2169             1400 16th Street                                         QVU   \n",
       "2172         3950 Johns Creek CT.                        Summary          MQF   \n",
       "2173            1800 Bering Drive                        Summary          ONF   \n",
       "\n",
       "     zip_code                      applicant decision_date  ...  \\\n",
       "22      19403           GLOBUS MEDICAL, INC.    2017-01-23  ...   \n",
       "39      19403           GLOBUS MEDICAL, INC.    2017-05-01  ...   \n",
       "44      07417  Becton, Dickinson and Company    2018-10-23  ...   \n",
       "47      21152  Becton, Dickinson and Company    2023-03-24  ...   \n",
       "48      07417  Becton, Dickinson and Company    2022-02-04  ...   \n",
       "...       ...                            ...           ...  ...   \n",
       "2166    94502                  Penumbra, Inc    2020-05-28  ...   \n",
       "2167    95132                  Penumbra, Inc    2022-11-04  ...   \n",
       "2169    94103            Invitae Corporation    2023-09-29  ...   \n",
       "2172    30024                   Femasys Inc.    2023-09-22  ...   \n",
       "2173    95112             Venus Concept Inc.    2023-09-11  ...   \n",
       "\n",
       "          decision_description clearance_type  \\\n",
       "22    Substantially Equivalent    Traditional   \n",
       "39    Substantially Equivalent    Traditional   \n",
       "44    Substantially Equivalent    Traditional   \n",
       "47    Substantially Equivalent        Special   \n",
       "48    Substantially Equivalent    Traditional   \n",
       "...                        ...            ...   \n",
       "2166  Substantially Equivalent    Traditional   \n",
       "2167  Substantially Equivalent    Traditional   \n",
       "2169                   Unknown         Direct   \n",
       "2172  Substantially Equivalent    Traditional   \n",
       "2173  Substantially Equivalent        Special   \n",
       "\n",
       "                            openfda.registration_number  \\\n",
       "22    [2648666, 3010032903, 2648623, 3010173425, 202...   \n",
       "39    [3007441485, 2648666, 3009149199, 9617544, 103...   \n",
       "44    [2648666, 9616066, 9617544, 3014314985, 804114...   \n",
       "47    [3003542872, 3010392988, 3009220482, 1111096, ...   \n",
       "48    [2320762, 1063851, 3009495876, 3015433750, 103...   \n",
       "...                                                 ...   \n",
       "2166  [3026201252, 3015614177, 1222140, 3027696665, ...   \n",
       "2167  [3012497308, 3012543881, 2029214, 3006010712, ...   \n",
       "2169                                                NaN   \n",
       "2172  [1216677, 3014755376, 3005941719, 1018470, 301...   \n",
       "2173  [3007085226, 3017905264, 3016170453, 300998260...   \n",
       "\n",
       "                                     openfda.fei_number  \\\n",
       "22    [2648666, 3010032903, 2648623, 3005677016, 224...   \n",
       "39    [3007441485, 2648666, 3003051987, 3009149199, ...   \n",
       "44    [2648666, 3003166194, 3014314985, 3002974635, ...   \n",
       "47    [3003542872, 3000215273, 3010392988, 1111096, ...   \n",
       "48    [1000174591, 3009495876, 3015433750, 300297463...   \n",
       "...                                                 ...   \n",
       "2166  [3002913962, 3000206435, 3026201252, 301561417...   \n",
       "2167  [3012497308, 3012543881, 3006010712, 1048735, ...   \n",
       "2169                                                NaN   \n",
       "2172  [3002807969, 3014755376, 1216677, 3014295858, ...   \n",
       "2173  [3007085226, 3017905264, 3016170453, 300998260...   \n",
       "\n",
       "                                    openfda.device_name  \\\n",
       "22                         Cement, Bone, Vertebroplasty   \n",
       "39                                Screw, Fixation, Bone   \n",
       "44                                      Syringe, Piston   \n",
       "47                              System, Blood Culturing   \n",
       "48    Tubes, Vials, Systems, Serum Separators, Blood...   \n",
       "...                                                 ...   \n",
       "2166  Peripheral Mechanical Thrombectomy With Aspira...   \n",
       "2167           Catheter, Percutaneous, Neurovasculature   \n",
       "2169                                                NaN   \n",
       "2172                    Catheter, Assisted Reproduction   \n",
       "2173  Powered Light Based Non-Laser Surgical Instrum...   \n",
       "\n",
       "     openfda.medical_specialty_description openfda.regulation_number  \\\n",
       "22                              Orthopedic                  888.3027   \n",
       "39                              Orthopedic                  888.3040   \n",
       "44                        General Hospital                  880.5860   \n",
       "47                            Microbiology                  866.2560   \n",
       "48                      Clinical Chemistry                  862.1675   \n",
       "...                                    ...                       ...   \n",
       "2166                        Cardiovascular                  870.5150   \n",
       "2167                        Cardiovascular                  870.1250   \n",
       "2169                                   NaN                       NaN   \n",
       "2172                 Obstetrics/Gynecology                  884.6110   \n",
       "2173              General, Plastic Surgery                  878.4810   \n",
       "\n",
       "     openfda.device_class      CIK                       SEC_name  \n",
       "22                      2  1237831           GLOBUS MEDICAL, INC.  \n",
       "39                      2  1237831           GLOBUS MEDICAL, INC.  \n",
       "44                      2    10795  Becton, Dickinson and Company  \n",
       "47                      1    10795  Becton, Dickinson and Company  \n",
       "48                      2    10795  Becton, Dickinson and Company  \n",
       "...                   ...      ...                            ...  \n",
       "2166                    2  1321732                  Penumbra, Inc  \n",
       "2167                    2  1321732                  Penumbra, Inc  \n",
       "2169                  NaN  1501134            Invitae Corporation  \n",
       "2172                    2  1339005                   Femasys Inc.  \n",
       "2173                    2  1409269             Venus Concept Inc.  \n",
       "\n",
       "[304 rows x 31 columns]"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_filtered = df_matches[df_matches['decision_date'] > '2017-01-01']\n",
    "df_filtered"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Get Company info"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>applicant</th>\n",
       "      <th>count</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>ABBOTT LABORATORIES</td>\n",
       "      <td>857</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>3M COMPANY</td>\n",
       "      <td>280</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>BIO-RAD LABORATORIES, INC.</td>\n",
       "      <td>78</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Becton, Dickinson and Company</td>\n",
       "      <td>71</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Intuitive Surgical, Inc.</td>\n",
       "      <td>51</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>119</th>\n",
       "      <td>HAEMONETICS CORPORATION</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>120</th>\n",
       "      <td>OPKO HEALTH, INC.</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>121</th>\n",
       "      <td>BONSO ELECTRONICS INTERNATIONAL INC.</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>122</th>\n",
       "      <td>SIGHT SCIENCES, INC.</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>123</th>\n",
       "      <td>SILK ROAD MEDICAL, INC.</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>124 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                applicant  count\n",
       "0                     ABBOTT LABORATORIES    857\n",
       "1                              3M COMPANY    280\n",
       "2              BIO-RAD LABORATORIES, INC.     78\n",
       "3           Becton, Dickinson and Company     71\n",
       "4                Intuitive Surgical, Inc.     51\n",
       "..                                    ...    ...\n",
       "119               HAEMONETICS CORPORATION      1\n",
       "120                     OPKO HEALTH, INC.      1\n",
       "121  BONSO ELECTRONICS INTERNATIONAL INC.      1\n",
       "122                  SIGHT SCIENCES, INC.      1\n",
       "123               SILK ROAD MEDICAL, INC.      1\n",
       "\n",
       "[124 rows x 2 columns]"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "num_applications = df_matches['applicant'].value_counts().reset_index()\n",
    "num_applications\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/var/folders/pk/h507p0sj5pv9r3h5333yh9vm0000gp/T/ipykernel_22901/512809141.py:1: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  df_filtered[\"decision_year\"] = df_filtered[\"decision_date\"].str[:4]\n",
      "/var/folders/pk/h507p0sj5pv9r3h5333yh9vm0000gp/T/ipykernel_22901/512809141.py:2: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  df_filtered[\"decision_year\"] = df_filtered[\"decision_year\"].astype(int)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "decision_year\n",
       "2017    56\n",
       "2022    46\n",
       "2021    46\n",
       "2018    43\n",
       "2023    42\n",
       "2020    36\n",
       "2019    35\n",
       "Name: count, dtype: int64"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_filtered[\"decision_year\"] = df_filtered[\"decision_date\"].str[:4]\n",
    "df_filtered[\"decision_year\"] = df_filtered[\"decision_year\"].astype(int)\n",
    "df_filtered[\"decision_year\"].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 80,
   "metadata": {},
   "outputs": [],
   "source": [
    "df_output_to_r = df_filtered[['applicant', 'CIK','decision_year']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 55/55 [00:01<00:00, 33.55it/s]\n"
     ]
    }
   ],
   "source": [
    "target_CIKs = df_output_to_r[\"CIK\"].unique()\n",
    "target_metrics = [\"GrossProfit\",\"CostsAndExpenses\",\"SellingGeneralAndAdministrativeExpense\",\"ProfitLoss\"]\n",
    "gathered_metrics = []\n",
    "\n",
    "\n",
    "for cik in tqdm.tqdm(target_CIKs):\n",
    "    file_name = glob.glob('/Users/dsan/My Drive/5000-Project/Data/Raw-data/SEC/companyfacts/*' + str(cik) + '*.json')[0]\n",
    "    with open(file_name, 'r') as f:\n",
    "        data = json.load(f)\n",
    "        for metric in target_metrics:\n",
    "            try:\n",
    "                all_years = data[\"facts\"][\"us-gaap\"][metric][\"units\"][\"USD\"]\n",
    "                for year in all_years:\n",
    "                    row = {}\n",
    "                    row[\"CIK\"] = cik\n",
    "                    row[\"metric\"] = metric\n",
    "                    row[\"financial_year\"] = year[\"fy\"]\n",
    "                    row[\"financial_period\"] = year[\"fp\"]\n",
    "                    row[\"start_date\"] = year[\"start\"]\n",
    "                    row[\"end_date\"] = year[\"end\"]\n",
    "                    row[\"filing_date\"] = year[\"filed\"]\n",
    "                    row[\"amount\"] = year[\"val\"]\n",
    "                    row[\"form\"] = year[\"form\"]\n",
    "                    gathered_metrics.append(row)\n",
    "            except:\n",
    "                continue"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>CIK</th>\n",
       "      <th>metric</th>\n",
       "      <th>financial_year</th>\n",
       "      <th>financial_period</th>\n",
       "      <th>start_date</th>\n",
       "      <th>end_date</th>\n",
       "      <th>filing_date</th>\n",
       "      <th>amount</th>\n",
       "      <th>form</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1237831</td>\n",
       "      <td>GrossProfit</td>\n",
       "      <td>2012.0</td>\n",
       "      <td>FY</td>\n",
       "      <td>2010-01-01</td>\n",
       "      <td>2010-12-31</td>\n",
       "      <td>2013-03-05</td>\n",
       "      <td>234370000</td>\n",
       "      <td>10-K</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1237831</td>\n",
       "      <td>GrossProfit</td>\n",
       "      <td>2012.0</td>\n",
       "      <td>FY</td>\n",
       "      <td>2010-01-01</td>\n",
       "      <td>2010-12-31</td>\n",
       "      <td>2013-06-13</td>\n",
       "      <td>234370000</td>\n",
       "      <td>10-K/A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1237831</td>\n",
       "      <td>GrossProfit</td>\n",
       "      <td>2012.0</td>\n",
       "      <td>FY</td>\n",
       "      <td>2011-01-01</td>\n",
       "      <td>2011-03-31</td>\n",
       "      <td>2013-03-05</td>\n",
       "      <td>63380000</td>\n",
       "      <td>10-K</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1237831</td>\n",
       "      <td>GrossProfit</td>\n",
       "      <td>2012.0</td>\n",
       "      <td>FY</td>\n",
       "      <td>2011-01-01</td>\n",
       "      <td>2011-03-31</td>\n",
       "      <td>2013-06-13</td>\n",
       "      <td>63380000</td>\n",
       "      <td>10-K/A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1237831</td>\n",
       "      <td>GrossProfit</td>\n",
       "      <td>2012.0</td>\n",
       "      <td>Q2</td>\n",
       "      <td>2011-01-01</td>\n",
       "      <td>2011-06-30</td>\n",
       "      <td>2012-09-19</td>\n",
       "      <td>127047000</td>\n",
       "      <td>10-Q/A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11652</th>\n",
       "      <td>1409269</td>\n",
       "      <td>ProfitLoss</td>\n",
       "      <td>2022.0</td>\n",
       "      <td>Q3</td>\n",
       "      <td>2022-07-01</td>\n",
       "      <td>2022-09-30</td>\n",
       "      <td>2022-11-10</td>\n",
       "      <td>-14496000</td>\n",
       "      <td>10-Q</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11653</th>\n",
       "      <td>1409269</td>\n",
       "      <td>ProfitLoss</td>\n",
       "      <td>2022.0</td>\n",
       "      <td>FY</td>\n",
       "      <td>2022-01-01</td>\n",
       "      <td>2022-12-31</td>\n",
       "      <td>2023-03-27</td>\n",
       "      <td>-43584000</td>\n",
       "      <td>10-K</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11654</th>\n",
       "      <td>1409269</td>\n",
       "      <td>ProfitLoss</td>\n",
       "      <td>2023.0</td>\n",
       "      <td>Q1</td>\n",
       "      <td>2023-01-01</td>\n",
       "      <td>2023-03-31</td>\n",
       "      <td>2023-05-15</td>\n",
       "      <td>-9623000</td>\n",
       "      <td>10-Q</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11655</th>\n",
       "      <td>1409269</td>\n",
       "      <td>ProfitLoss</td>\n",
       "      <td>2023.0</td>\n",
       "      <td>Q2</td>\n",
       "      <td>2023-01-01</td>\n",
       "      <td>2023-06-30</td>\n",
       "      <td>2023-08-14</td>\n",
       "      <td>-16944000</td>\n",
       "      <td>10-Q</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11656</th>\n",
       "      <td>1409269</td>\n",
       "      <td>ProfitLoss</td>\n",
       "      <td>2023.0</td>\n",
       "      <td>Q2</td>\n",
       "      <td>2023-04-01</td>\n",
       "      <td>2023-06-30</td>\n",
       "      <td>2023-08-14</td>\n",
       "      <td>-7321000</td>\n",
       "      <td>10-Q</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>11657 rows × 9 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "           CIK       metric  financial_year financial_period  start_date  \\\n",
       "0      1237831  GrossProfit          2012.0               FY  2010-01-01   \n",
       "1      1237831  GrossProfit          2012.0               FY  2010-01-01   \n",
       "2      1237831  GrossProfit          2012.0               FY  2011-01-01   \n",
       "3      1237831  GrossProfit          2012.0               FY  2011-01-01   \n",
       "4      1237831  GrossProfit          2012.0               Q2  2011-01-01   \n",
       "...        ...          ...             ...              ...         ...   \n",
       "11652  1409269   ProfitLoss          2022.0               Q3  2022-07-01   \n",
       "11653  1409269   ProfitLoss          2022.0               FY  2022-01-01   \n",
       "11654  1409269   ProfitLoss          2023.0               Q1  2023-01-01   \n",
       "11655  1409269   ProfitLoss          2023.0               Q2  2023-01-01   \n",
       "11656  1409269   ProfitLoss          2023.0               Q2  2023-04-01   \n",
       "\n",
       "         end_date filing_date     amount    form  \n",
       "0      2010-12-31  2013-03-05  234370000    10-K  \n",
       "1      2010-12-31  2013-06-13  234370000  10-K/A  \n",
       "2      2011-03-31  2013-03-05   63380000    10-K  \n",
       "3      2011-03-31  2013-06-13   63380000  10-K/A  \n",
       "4      2011-06-30  2012-09-19  127047000  10-Q/A  \n",
       "...           ...         ...        ...     ...  \n",
       "11652  2022-09-30  2022-11-10  -14496000    10-Q  \n",
       "11653  2022-12-31  2023-03-27  -43584000    10-K  \n",
       "11654  2023-03-31  2023-05-15   -9623000    10-Q  \n",
       "11655  2023-06-30  2023-08-14  -16944000    10-Q  \n",
       "11656  2023-06-30  2023-08-14   -7321000    10-Q  \n",
       "\n",
       "[11657 rows x 9 columns]"
      ]
     },
     "execution_count": 51,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "financials_df = pd.DataFrame(gathered_metrics)\n",
    "financials_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>CIK</th>\n",
       "      <th>metric</th>\n",
       "      <th>financial_year</th>\n",
       "      <th>financial_period</th>\n",
       "      <th>start_date</th>\n",
       "      <th>end_date</th>\n",
       "      <th>filing_date</th>\n",
       "      <th>amount</th>\n",
       "      <th>form</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1237831</td>\n",
       "      <td>GrossProfit</td>\n",
       "      <td>2012.0</td>\n",
       "      <td>FY</td>\n",
       "      <td>2010-01-01</td>\n",
       "      <td>2010-12-31</td>\n",
       "      <td>2013-03-05</td>\n",
       "      <td>234370000</td>\n",
       "      <td>10-K</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1237831</td>\n",
       "      <td>GrossProfit</td>\n",
       "      <td>2012.0</td>\n",
       "      <td>FY</td>\n",
       "      <td>2010-01-01</td>\n",
       "      <td>2010-12-31</td>\n",
       "      <td>2013-06-13</td>\n",
       "      <td>234370000</td>\n",
       "      <td>10-K/A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1237831</td>\n",
       "      <td>GrossProfit</td>\n",
       "      <td>2012.0</td>\n",
       "      <td>FY</td>\n",
       "      <td>2011-01-01</td>\n",
       "      <td>2011-03-31</td>\n",
       "      <td>2013-03-05</td>\n",
       "      <td>63380000</td>\n",
       "      <td>10-K</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1237831</td>\n",
       "      <td>GrossProfit</td>\n",
       "      <td>2012.0</td>\n",
       "      <td>FY</td>\n",
       "      <td>2011-01-01</td>\n",
       "      <td>2011-03-31</td>\n",
       "      <td>2013-06-13</td>\n",
       "      <td>63380000</td>\n",
       "      <td>10-K/A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1237831</td>\n",
       "      <td>GrossProfit</td>\n",
       "      <td>2012.0</td>\n",
       "      <td>Q2</td>\n",
       "      <td>2011-01-01</td>\n",
       "      <td>2011-06-30</td>\n",
       "      <td>2012-09-19</td>\n",
       "      <td>127047000</td>\n",
       "      <td>10-Q/A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11652</th>\n",
       "      <td>1409269</td>\n",
       "      <td>ProfitLoss</td>\n",
       "      <td>2022.0</td>\n",
       "      <td>Q3</td>\n",
       "      <td>2022-07-01</td>\n",
       "      <td>2022-09-30</td>\n",
       "      <td>2022-11-10</td>\n",
       "      <td>-14496000</td>\n",
       "      <td>10-Q</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11653</th>\n",
       "      <td>1409269</td>\n",
       "      <td>ProfitLoss</td>\n",
       "      <td>2022.0</td>\n",
       "      <td>FY</td>\n",
       "      <td>2022-01-01</td>\n",
       "      <td>2022-12-31</td>\n",
       "      <td>2023-03-27</td>\n",
       "      <td>-43584000</td>\n",
       "      <td>10-K</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11654</th>\n",
       "      <td>1409269</td>\n",
       "      <td>ProfitLoss</td>\n",
       "      <td>2023.0</td>\n",
       "      <td>Q1</td>\n",
       "      <td>2023-01-01</td>\n",
       "      <td>2023-03-31</td>\n",
       "      <td>2023-05-15</td>\n",
       "      <td>-9623000</td>\n",
       "      <td>10-Q</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11655</th>\n",
       "      <td>1409269</td>\n",
       "      <td>ProfitLoss</td>\n",
       "      <td>2023.0</td>\n",
       "      <td>Q2</td>\n",
       "      <td>2023-01-01</td>\n",
       "      <td>2023-06-30</td>\n",
       "      <td>2023-08-14</td>\n",
       "      <td>-16944000</td>\n",
       "      <td>10-Q</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11656</th>\n",
       "      <td>1409269</td>\n",
       "      <td>ProfitLoss</td>\n",
       "      <td>2023.0</td>\n",
       "      <td>Q2</td>\n",
       "      <td>2023-04-01</td>\n",
       "      <td>2023-06-30</td>\n",
       "      <td>2023-08-14</td>\n",
       "      <td>-7321000</td>\n",
       "      <td>10-Q</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>11657 rows × 9 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "           CIK       metric  financial_year financial_period start_date  \\\n",
       "0      1237831  GrossProfit          2012.0               FY 2010-01-01   \n",
       "1      1237831  GrossProfit          2012.0               FY 2010-01-01   \n",
       "2      1237831  GrossProfit          2012.0               FY 2011-01-01   \n",
       "3      1237831  GrossProfit          2012.0               FY 2011-01-01   \n",
       "4      1237831  GrossProfit          2012.0               Q2 2011-01-01   \n",
       "...        ...          ...             ...              ...        ...   \n",
       "11652  1409269   ProfitLoss          2022.0               Q3 2022-07-01   \n",
       "11653  1409269   ProfitLoss          2022.0               FY 2022-01-01   \n",
       "11654  1409269   ProfitLoss          2023.0               Q1 2023-01-01   \n",
       "11655  1409269   ProfitLoss          2023.0               Q2 2023-01-01   \n",
       "11656  1409269   ProfitLoss          2023.0               Q2 2023-04-01   \n",
       "\n",
       "        end_date filing_date     amount    form  \n",
       "0     2010-12-31  2013-03-05  234370000    10-K  \n",
       "1     2010-12-31  2013-06-13  234370000  10-K/A  \n",
       "2     2011-03-31  2013-03-05   63380000    10-K  \n",
       "3     2011-03-31  2013-06-13   63380000  10-K/A  \n",
       "4     2011-06-30  2012-09-19  127047000  10-Q/A  \n",
       "...          ...         ...        ...     ...  \n",
       "11652 2022-09-30  2022-11-10  -14496000    10-Q  \n",
       "11653 2022-12-31  2023-03-27  -43584000    10-K  \n",
       "11654 2023-03-31  2023-05-15   -9623000    10-Q  \n",
       "11655 2023-06-30  2023-08-14  -16944000    10-Q  \n",
       "11656 2023-06-30  2023-08-14   -7321000    10-Q  \n",
       "\n",
       "[11657 rows x 9 columns]"
      ]
     },
     "execution_count": 53,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Converting start_date, end_date, filing date to datetime\n",
    "\n",
    "financials_df[\"start_date\"] = pd.to_datetime(financials_df[\"start_date\"])\n",
    "financials_df[\"end_date\"] = pd.to_datetime(financials_df[\"end_date\"])\n",
    "financials_df[\"filing_date\"] = pd.to_datetime(financials_df[\"filing_date\"])\n",
    "\n",
    "financials_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Filtering to only 10Ks\n",
    "\n",
    "financials_df = financials_df[financials_df[\"form\"] == \"10-K\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>CIK</th>\n",
       "      <th>metric</th>\n",
       "      <th>financial_year</th>\n",
       "      <th>financial_period</th>\n",
       "      <th>start_date</th>\n",
       "      <th>end_date</th>\n",
       "      <th>filing_date</th>\n",
       "      <th>amount</th>\n",
       "      <th>form</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1237831</td>\n",
       "      <td>GrossProfit</td>\n",
       "      <td>2012.0</td>\n",
       "      <td>FY</td>\n",
       "      <td>2010-01-01</td>\n",
       "      <td>2010-12-31</td>\n",
       "      <td>2013-03-05</td>\n",
       "      <td>234370000</td>\n",
       "      <td>10-K</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1237831</td>\n",
       "      <td>GrossProfit</td>\n",
       "      <td>2012.0</td>\n",
       "      <td>FY</td>\n",
       "      <td>2011-01-01</td>\n",
       "      <td>2011-03-31</td>\n",
       "      <td>2013-03-05</td>\n",
       "      <td>63380000</td>\n",
       "      <td>10-K</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>1237831</td>\n",
       "      <td>GrossProfit</td>\n",
       "      <td>2012.0</td>\n",
       "      <td>FY</td>\n",
       "      <td>2011-04-01</td>\n",
       "      <td>2011-06-30</td>\n",
       "      <td>2013-03-05</td>\n",
       "      <td>63667000</td>\n",
       "      <td>10-K</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>1237831</td>\n",
       "      <td>GrossProfit</td>\n",
       "      <td>2012.0</td>\n",
       "      <td>FY</td>\n",
       "      <td>2011-07-01</td>\n",
       "      <td>2011-09-30</td>\n",
       "      <td>2013-03-05</td>\n",
       "      <td>67129000</td>\n",
       "      <td>10-K</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>1237831</td>\n",
       "      <td>GrossProfit</td>\n",
       "      <td>2012.0</td>\n",
       "      <td>FY</td>\n",
       "      <td>2011-01-01</td>\n",
       "      <td>2011-12-31</td>\n",
       "      <td>2013-03-05</td>\n",
       "      <td>262682000</td>\n",
       "      <td>10-K</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11630</th>\n",
       "      <td>1409269</td>\n",
       "      <td>ProfitLoss</td>\n",
       "      <td>2020.0</td>\n",
       "      <td>FY</td>\n",
       "      <td>2020-01-01</td>\n",
       "      <td>2020-12-31</td>\n",
       "      <td>2021-03-29</td>\n",
       "      <td>-82818000</td>\n",
       "      <td>10-K</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11632</th>\n",
       "      <td>1409269</td>\n",
       "      <td>ProfitLoss</td>\n",
       "      <td>2021.0</td>\n",
       "      <td>FY</td>\n",
       "      <td>2020-01-01</td>\n",
       "      <td>2020-12-31</td>\n",
       "      <td>2022-03-28</td>\n",
       "      <td>-82818000</td>\n",
       "      <td>10-K</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11643</th>\n",
       "      <td>1409269</td>\n",
       "      <td>ProfitLoss</td>\n",
       "      <td>2021.0</td>\n",
       "      <td>FY</td>\n",
       "      <td>2021-01-01</td>\n",
       "      <td>2021-12-31</td>\n",
       "      <td>2022-03-28</td>\n",
       "      <td>-22141000</td>\n",
       "      <td>10-K</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11644</th>\n",
       "      <td>1409269</td>\n",
       "      <td>ProfitLoss</td>\n",
       "      <td>2022.0</td>\n",
       "      <td>FY</td>\n",
       "      <td>2021-01-01</td>\n",
       "      <td>2021-12-31</td>\n",
       "      <td>2023-03-27</td>\n",
       "      <td>-22141000</td>\n",
       "      <td>10-K</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11653</th>\n",
       "      <td>1409269</td>\n",
       "      <td>ProfitLoss</td>\n",
       "      <td>2022.0</td>\n",
       "      <td>FY</td>\n",
       "      <td>2022-01-01</td>\n",
       "      <td>2022-12-31</td>\n",
       "      <td>2023-03-27</td>\n",
       "      <td>-43584000</td>\n",
       "      <td>10-K</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3962 rows × 9 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "           CIK       metric  financial_year financial_period start_date  \\\n",
       "0      1237831  GrossProfit          2012.0               FY 2010-01-01   \n",
       "2      1237831  GrossProfit          2012.0               FY 2011-01-01   \n",
       "6      1237831  GrossProfit          2012.0               FY 2011-04-01   \n",
       "10     1237831  GrossProfit          2012.0               FY 2011-07-01   \n",
       "12     1237831  GrossProfit          2012.0               FY 2011-01-01   \n",
       "...        ...          ...             ...              ...        ...   \n",
       "11630  1409269   ProfitLoss          2020.0               FY 2020-01-01   \n",
       "11632  1409269   ProfitLoss          2021.0               FY 2020-01-01   \n",
       "11643  1409269   ProfitLoss          2021.0               FY 2021-01-01   \n",
       "11644  1409269   ProfitLoss          2022.0               FY 2021-01-01   \n",
       "11653  1409269   ProfitLoss          2022.0               FY 2022-01-01   \n",
       "\n",
       "        end_date filing_date     amount  form  \n",
       "0     2010-12-31  2013-03-05  234370000  10-K  \n",
       "2     2011-03-31  2013-03-05   63380000  10-K  \n",
       "6     2011-06-30  2013-03-05   63667000  10-K  \n",
       "10    2011-09-30  2013-03-05   67129000  10-K  \n",
       "12    2011-12-31  2013-03-05  262682000  10-K  \n",
       "...          ...         ...        ...   ...  \n",
       "11630 2020-12-31  2021-03-29  -82818000  10-K  \n",
       "11632 2020-12-31  2022-03-28  -82818000  10-K  \n",
       "11643 2021-12-31  2022-03-28  -22141000  10-K  \n",
       "11644 2021-12-31  2023-03-27  -22141000  10-K  \n",
       "11653 2022-12-31  2023-03-27  -43584000  10-K  \n",
       "\n",
       "[3962 rows x 9 columns]"
      ]
     },
     "execution_count": 55,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Filtering to only FY financial period\n",
    "\n",
    "financials_df = financials_df[financials_df[\"financial_period\"] == \"FY\"]\n",
    "financials_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "## I want to keep for some same CIK, METRIC, and Financial year only the row that has the largest absolute value of amount\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Makes abs_amount and sign columns for easier analysis\n",
    "\n",
    "financials_df[\"abs_amount\"] = financials_df[\"amount\"].abs()\n",
    "financials_df[\"sign\"] = financials_df[\"amount\"].apply(lambda x: 1 if x > 0 else -1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>CIK</th>\n",
       "      <th>metric</th>\n",
       "      <th>financial_year</th>\n",
       "      <th>financial_period</th>\n",
       "      <th>start_date</th>\n",
       "      <th>end_date</th>\n",
       "      <th>filing_date</th>\n",
       "      <th>amount</th>\n",
       "      <th>form</th>\n",
       "      <th>abs_amount</th>\n",
       "      <th>sign</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>10653</th>\n",
       "      <td>8818</td>\n",
       "      <td>CostsAndExpenses</td>\n",
       "      <td>2014.0</td>\n",
       "      <td>FY</td>\n",
       "      <td>2014-04-01</td>\n",
       "      <td>2015-03-31</td>\n",
       "      <td>2015-05-26</td>\n",
       "      <td>158035000</td>\n",
       "      <td>10-K</td>\n",
       "      <td>158035000</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10429</th>\n",
       "      <td>8818</td>\n",
       "      <td>GrossProfit</td>\n",
       "      <td>2010.0</td>\n",
       "      <td>FY</td>\n",
       "      <td>2010-04-01</td>\n",
       "      <td>2011-03-31</td>\n",
       "      <td>2011-05-27</td>\n",
       "      <td>225881000</td>\n",
       "      <td>10-K</td>\n",
       "      <td>225881000</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10452</th>\n",
       "      <td>8818</td>\n",
       "      <td>GrossProfit</td>\n",
       "      <td>2011.0</td>\n",
       "      <td>FY</td>\n",
       "      <td>2011-04-01</td>\n",
       "      <td>2012-03-31</td>\n",
       "      <td>2012-05-25</td>\n",
       "      <td>278612000</td>\n",
       "      <td>10-K</td>\n",
       "      <td>278612000</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10453</th>\n",
       "      <td>8818</td>\n",
       "      <td>GrossProfit</td>\n",
       "      <td>2012.0</td>\n",
       "      <td>FY</td>\n",
       "      <td>2011-04-01</td>\n",
       "      <td>2012-03-31</td>\n",
       "      <td>2013-05-30</td>\n",
       "      <td>278612000</td>\n",
       "      <td>10-K</td>\n",
       "      <td>278612000</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10454</th>\n",
       "      <td>8818</td>\n",
       "      <td>GrossProfit</td>\n",
       "      <td>2013.0</td>\n",
       "      <td>FY</td>\n",
       "      <td>2011-04-01</td>\n",
       "      <td>2012-03-31</td>\n",
       "      <td>2014-05-29</td>\n",
       "      <td>278612000</td>\n",
       "      <td>10-K</td>\n",
       "      <td>278612000</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3296</th>\n",
       "      <td>1833769</td>\n",
       "      <td>ProfitLoss</td>\n",
       "      <td>2022.0</td>\n",
       "      <td>FY</td>\n",
       "      <td>2022-01-01</td>\n",
       "      <td>2022-12-31</td>\n",
       "      <td>2023-03-22</td>\n",
       "      <td>-73164000</td>\n",
       "      <td>10-K</td>\n",
       "      <td>73164000</td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8315</th>\n",
       "      <td>1835567</td>\n",
       "      <td>CostsAndExpenses</td>\n",
       "      <td>2021.0</td>\n",
       "      <td>FY</td>\n",
       "      <td>2021-01-01</td>\n",
       "      <td>2021-12-31</td>\n",
       "      <td>2022-03-29</td>\n",
       "      <td>109893000</td>\n",
       "      <td>10-K</td>\n",
       "      <td>109893000</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8322</th>\n",
       "      <td>1835567</td>\n",
       "      <td>CostsAndExpenses</td>\n",
       "      <td>2022.0</td>\n",
       "      <td>FY</td>\n",
       "      <td>2022-01-01</td>\n",
       "      <td>2022-12-31</td>\n",
       "      <td>2023-03-31</td>\n",
       "      <td>136044000</td>\n",
       "      <td>10-K</td>\n",
       "      <td>136044000</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8329</th>\n",
       "      <td>1835567</td>\n",
       "      <td>SellingGeneralAndAdministrativeExpense</td>\n",
       "      <td>2021.0</td>\n",
       "      <td>FY</td>\n",
       "      <td>2021-01-01</td>\n",
       "      <td>2021-12-31</td>\n",
       "      <td>2022-03-29</td>\n",
       "      <td>67619000</td>\n",
       "      <td>10-K</td>\n",
       "      <td>67619000</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8336</th>\n",
       "      <td>1835567</td>\n",
       "      <td>SellingGeneralAndAdministrativeExpense</td>\n",
       "      <td>2022.0</td>\n",
       "      <td>FY</td>\n",
       "      <td>2022-01-01</td>\n",
       "      <td>2022-12-31</td>\n",
       "      <td>2023-03-31</td>\n",
       "      <td>79551000</td>\n",
       "      <td>10-K</td>\n",
       "      <td>79551000</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>749 rows × 11 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "           CIK                                  metric  financial_year  \\\n",
       "10653     8818                        CostsAndExpenses          2014.0   \n",
       "10429     8818                             GrossProfit          2010.0   \n",
       "10452     8818                             GrossProfit          2011.0   \n",
       "10453     8818                             GrossProfit          2012.0   \n",
       "10454     8818                             GrossProfit          2013.0   \n",
       "...        ...                                     ...             ...   \n",
       "3296   1833769                              ProfitLoss          2022.0   \n",
       "8315   1835567                        CostsAndExpenses          2021.0   \n",
       "8322   1835567                        CostsAndExpenses          2022.0   \n",
       "8329   1835567  SellingGeneralAndAdministrativeExpense          2021.0   \n",
       "8336   1835567  SellingGeneralAndAdministrativeExpense          2022.0   \n",
       "\n",
       "      financial_period start_date   end_date filing_date     amount  form  \\\n",
       "10653               FY 2014-04-01 2015-03-31  2015-05-26  158035000  10-K   \n",
       "10429               FY 2010-04-01 2011-03-31  2011-05-27  225881000  10-K   \n",
       "10452               FY 2011-04-01 2012-03-31  2012-05-25  278612000  10-K   \n",
       "10453               FY 2011-04-01 2012-03-31  2013-05-30  278612000  10-K   \n",
       "10454               FY 2011-04-01 2012-03-31  2014-05-29  278612000  10-K   \n",
       "...                ...        ...        ...         ...        ...   ...   \n",
       "3296                FY 2022-01-01 2022-12-31  2023-03-22  -73164000  10-K   \n",
       "8315                FY 2021-01-01 2021-12-31  2022-03-29  109893000  10-K   \n",
       "8322                FY 2022-01-01 2022-12-31  2023-03-31  136044000  10-K   \n",
       "8329                FY 2021-01-01 2021-12-31  2022-03-29   67619000  10-K   \n",
       "8336                FY 2022-01-01 2022-12-31  2023-03-31   79551000  10-K   \n",
       "\n",
       "       abs_amount  sign  \n",
       "10653   158035000     1  \n",
       "10429   225881000     1  \n",
       "10452   278612000     1  \n",
       "10453   278612000     1  \n",
       "10454   278612000     1  \n",
       "...           ...   ...  \n",
       "3296     73164000    -1  \n",
       "8315    109893000     1  \n",
       "8322    136044000     1  \n",
       "8329     67619000     1  \n",
       "8336     79551000     1  \n",
       "\n",
       "[749 rows x 11 columns]"
      ]
     },
     "execution_count": 61,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Group by CIK, Metric, Financial Year and take max of absolute value of abs_amount\n",
    "\n",
    "correct_indicies = financials_df.groupby([\"CIK\", \"metric\", \"financial_year\"])[\"amount\"].apply(lambda x: x.abs().idxmax()).reset_index()\n",
    "financials_df.loc[correct_indicies[\"amount\"]]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Transform data such that turns values in amount column into columns with values in amount column as values for each cik and financial year\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>CIK</th>\n",
       "      <th>metric</th>\n",
       "      <th>financial_year</th>\n",
       "      <th>amount</th>\n",
       "      <th>form</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>102</th>\n",
       "      <td>1237831</td>\n",
       "      <td>GrossProfit</td>\n",
       "      <td>2017.0</td>\n",
       "      <td>412420000</td>\n",
       "      <td>10-K</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>108</th>\n",
       "      <td>1237831</td>\n",
       "      <td>GrossProfit</td>\n",
       "      <td>2017.0</td>\n",
       "      <td>107745000</td>\n",
       "      <td>10-K</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>114</th>\n",
       "      <td>1237831</td>\n",
       "      <td>GrossProfit</td>\n",
       "      <td>2017.0</td>\n",
       "      <td>104758000</td>\n",
       "      <td>10-K</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>120</th>\n",
       "      <td>1237831</td>\n",
       "      <td>GrossProfit</td>\n",
       "      <td>2017.0</td>\n",
       "      <td>104198000</td>\n",
       "      <td>10-K</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>122</th>\n",
       "      <td>1237831</td>\n",
       "      <td>GrossProfit</td>\n",
       "      <td>2017.0</td>\n",
       "      <td>429289000</td>\n",
       "      <td>10-K</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11630</th>\n",
       "      <td>1409269</td>\n",
       "      <td>ProfitLoss</td>\n",
       "      <td>2020.0</td>\n",
       "      <td>-82818000</td>\n",
       "      <td>10-K</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11632</th>\n",
       "      <td>1409269</td>\n",
       "      <td>ProfitLoss</td>\n",
       "      <td>2021.0</td>\n",
       "      <td>-82818000</td>\n",
       "      <td>10-K</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11643</th>\n",
       "      <td>1409269</td>\n",
       "      <td>ProfitLoss</td>\n",
       "      <td>2021.0</td>\n",
       "      <td>-22141000</td>\n",
       "      <td>10-K</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11644</th>\n",
       "      <td>1409269</td>\n",
       "      <td>ProfitLoss</td>\n",
       "      <td>2022.0</td>\n",
       "      <td>-22141000</td>\n",
       "      <td>10-K</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11653</th>\n",
       "      <td>1409269</td>\n",
       "      <td>ProfitLoss</td>\n",
       "      <td>2022.0</td>\n",
       "      <td>-43584000</td>\n",
       "      <td>10-K</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2111 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "           CIK       metric  financial_year     amount  form\n",
       "102    1237831  GrossProfit          2017.0  412420000  10-K\n",
       "108    1237831  GrossProfit          2017.0  107745000  10-K\n",
       "114    1237831  GrossProfit          2017.0  104758000  10-K\n",
       "120    1237831  GrossProfit          2017.0  104198000  10-K\n",
       "122    1237831  GrossProfit          2017.0  429289000  10-K\n",
       "...        ...          ...             ...        ...   ...\n",
       "11630  1409269   ProfitLoss          2020.0  -82818000  10-K\n",
       "11632  1409269   ProfitLoss          2021.0  -82818000  10-K\n",
       "11643  1409269   ProfitLoss          2021.0  -22141000  10-K\n",
       "11644  1409269   ProfitLoss          2022.0  -22141000  10-K\n",
       "11653  1409269   ProfitLoss          2022.0  -43584000  10-K\n",
       "\n",
       "[2111 rows x 5 columns]"
      ]
     },
     "execution_count": 35,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Filtering for finanical_year 2017 and later\n",
    "\n",
    "financials_df = financials_df[financials_df[\"financial_year\"] >= 2017]\n",
    "financials_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 67,
   "metadata": {},
   "outputs": [],
   "source": [
    "transform_list = []\n",
    "\n",
    "for year in range(2017, 2023):\n",
    "    for cik in target_CIKs:\n",
    "        row = {}\n",
    "        row[\"CIK\"] = cik\n",
    "        row[\"financial_year\"] = year\n",
    "        for metric in target_metrics:\n",
    "            try:\n",
    "                row_metric =financials_df.loc[(financials_df[\"financial_year\"] == year) & (financials_df[\"CIK\"] == cik) & (financials_df[\"metric\"] == metric), \"amount\"].values[0]\n",
    "                row[metric] = row_metric\n",
    "            except:\n",
    "                row[metric] = pd.NA\n",
    "        transform_list.append(row)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 68,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>CIK</th>\n",
       "      <th>financial_year</th>\n",
       "      <th>GrossProfit</th>\n",
       "      <th>CostsAndExpenses</th>\n",
       "      <th>SellingGeneralAndAdministrativeExpense</th>\n",
       "      <th>ProfitLoss</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1237831</td>\n",
       "      <td>2017</td>\n",
       "      <td>412420000</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>210241000</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>10795</td>\n",
       "      <td>2017</td>\n",
       "      <td>1408000000</td>\n",
       "      <td>9207000000</td>\n",
       "      <td>2563000000</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1800</td>\n",
       "      <td>2017</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>66740</td>\n",
       "      <td>2017</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>23328000000</td>\n",
       "      <td>6229000000</td>\n",
       "      <td>4841000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>885725</td>\n",
       "      <td>2017</td>\n",
       "      <td>5304000000</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>2873000000</td>\n",
       "      <td>-239000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>325</th>\n",
       "      <td>1253176</td>\n",
       "      <td>2022</td>\n",
       "      <td>53188000</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>-59800000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>326</th>\n",
       "      <td>1321732</td>\n",
       "      <td>2022</td>\n",
       "      <td>338175000</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>287068000</td>\n",
       "      <td>-19257000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>327</th>\n",
       "      <td>1501134</td>\n",
       "      <td>2022</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>931770000</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>328</th>\n",
       "      <td>1339005</td>\n",
       "      <td>2022</td>\n",
       "      <td>809305</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>329</th>\n",
       "      <td>1409269</td>\n",
       "      <td>2022</td>\n",
       "      <td>74094000</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>-22141000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>330 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         CIK  financial_year GrossProfit CostsAndExpenses  \\\n",
       "0    1237831            2017   412420000             <NA>   \n",
       "1      10795            2017  1408000000       9207000000   \n",
       "2       1800            2017        <NA>             <NA>   \n",
       "3      66740            2017        <NA>      23328000000   \n",
       "4     885725            2017  5304000000             <NA>   \n",
       "..       ...             ...         ...              ...   \n",
       "325  1253176            2022    53188000             <NA>   \n",
       "326  1321732            2022   338175000             <NA>   \n",
       "327  1501134            2022        <NA>        931770000   \n",
       "328  1339005            2022      809305             <NA>   \n",
       "329  1409269            2022    74094000             <NA>   \n",
       "\n",
       "    SellingGeneralAndAdministrativeExpense  ProfitLoss  \n",
       "0                                210241000        <NA>  \n",
       "1                               2563000000        <NA>  \n",
       "2                                     <NA>        <NA>  \n",
       "3                               6229000000  4841000000  \n",
       "4                               2873000000  -239000000  \n",
       "..                                     ...         ...  \n",
       "325                                   <NA>   -59800000  \n",
       "326                              287068000   -19257000  \n",
       "327                                   <NA>        <NA>  \n",
       "328                                   <NA>        <NA>  \n",
       "329                                   <NA>   -22141000  \n",
       "\n",
       "[330 rows x 6 columns]"
      ]
     },
     "execution_count": 68,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "transformed_financials_df = pd.DataFrame(transform_list)\n",
    "transformed_financials_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 89,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0       412420000\n",
       "1       412420000\n",
       "2      1452000000\n",
       "3      1452000000\n",
       "4      1452000000\n",
       "          ...    \n",
       "257          <NA>\n",
       "258     266862000\n",
       "259       4245000\n",
       "260     292533000\n",
       "261     338175000\n",
       "Name: GrossProfit, Length: 262, dtype: object"
      ]
     },
     "execution_count": 89,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "## merge transformed fincancials df with df_filtered\n",
    "\n",
    "df_filtered.merge(transformed_financials_df, left_on=[\"CIK\",\"decision_year\"], right_on=[\"CIK\",\"financial_year\"])\n",
    "df_filtered.merge(transformed_financials_df, left_on=[\"CIK\",\"decision_year\"], right_on=[\"CIK\",\"financial_year\"])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Getting Financials"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 85,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[1237831,\n",
       " 10795,\n",
       " 1800,\n",
       " 66740,\n",
       " 885725,\n",
       " 1531978,\n",
       " 913165,\n",
       " 1642545,\n",
       " 320193,\n",
       " 1037760,\n",
       " 1833769,\n",
       " 1407973,\n",
       " 924717,\n",
       " 1035267,\n",
       " 1004945,\n",
       " 1285550,\n",
       " 1438133,\n",
       " 1494891,\n",
       " 1531048,\n",
       " 1484612,\n",
       " 1275187,\n",
       " 1145197,\n",
       " 1668243,\n",
       " 1588978,\n",
       " 1630627,\n",
       " 1804176,\n",
       " 1138723,\n",
       " 1742692,\n",
       " 1323885,\n",
       " 794172,\n",
       " 105770,\n",
       " 1505065,\n",
       " 1388658,\n",
       " 1162461,\n",
       " 1716166,\n",
       " 1625101,\n",
       " 1512138,\n",
       " 898437,\n",
       " 1607962,\n",
       " 1835567,\n",
       " 721371,\n",
       " 1522860,\n",
       " 1716621,\n",
       " 1566469,\n",
       " 313143,\n",
       " 1492674,\n",
       " 1719395,\n",
       " 1640266,\n",
       " 8818,\n",
       " 1628945,\n",
       " 1253176,\n",
       " 1321732,\n",
       " 1501134,\n",
       " 1339005,\n",
       " 1409269]"
      ]
     },
     "execution_count": 85,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "r_CIKS = list(df_output_to_r['CIK'].unique())\n",
    "r_CIKS"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### API Call to Match Company Names with CIKs"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 87,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      " [1] 1237831   10795    1800   66740  885725 1531978  913165 1642545  320193\n",
      "[10] 1037760 1833769 1407973  924717 1035267 1004945 1285550 1438133 1494891\n",
      "[19] 1531048 1484612 1275187 1145197 1668243 1588978 1630627 1804176 1138723\n",
      "[28] 1742692 1323885  794172  105770 1505065 1388658 1162461 1716166 1625101\n",
      "[37] 1512138  898437 1607962 1835567  721371 1522860 1716621 1566469  313143\n",
      "[46] 1492674 1719395 1640266    8818 1628945 1253176 1321732 1501134 1339005\n",
      "[55] 1409269\n",
      "Downloading Master Indexes from SEC server for 2017 ...\n",
      "Master Index for quarter 1 \n",
      "Master Index for quarter 2 \n",
      "Master Index for quarter 3 \n",
      "Master Index for quarter 4 \n",
      "Downloading Master Indexes from SEC server for 2018 ...\n",
      "Master Index for quarter 1 \n",
      "Master Index for quarter 2 \n",
      "Master Index for quarter 3 \n",
      "Master Index for quarter 4 \n",
      "Downloading Master Indexes from SEC server for 2019 ...\n",
      "Master Index for quarter 1 \n",
      "Master Index for quarter 2 \n",
      "Master Index for quarter 3 \n",
      "Master Index for quarter 4 \n",
      "Downloading Master Indexes from SEC server for 2020 ...\n",
      "Master Index for quarter 1 \n",
      "Master Index for quarter 2 \n",
      "Master Index for quarter 3 \n",
      "Master Index for quarter 4 \n",
      "Downloading Master Indexes from SEC server for 2021 ...\n",
      "Master Index for quarter 1 \n",
      "Master Index for quarter 2 \n",
      "Master Index for quarter 3 \n",
      "Master Index for quarter 4 \n",
      "Downloading Master Indexes from SEC server for 2022 ...\n",
      "Master Index for quarter 1 \n",
      "Master Index for quarter 2 \n",
      "Master Index for quarter 3 \n",
      "Master Index for quarter 4 \n",
      "Downloading fillings. Please wait... \n",
      "  |======================================================================| 100%\n",
      "Extracting 'Item 1' section...\n",
      "  |======================================================================| 100%\n",
      "Business descriptions are stored in 'Business descriptions text' directory.        cik                        company.name form.type date.filed\n",
      "1   1035267              INTUITIVE SURGICAL INC      10-K 2017-02-06\n",
      "2   1035267              INTUITIVE SURGICAL INC      10-K 2018-02-02\n",
      "3   1035267              INTUITIVE SURGICAL INC      10-K 2019-02-04\n",
      "4   1035267              INTUITIVE SURGICAL INC      10-K 2020-02-07\n",
      "5   1035267              INTUITIVE SURGICAL INC      10-K 2021-02-10\n",
      "6   1035267              INTUITIVE SURGICAL INC      10-K 2022-02-03\n",
      "7    105770    WEST PHARMACEUTICAL SERVICES INC      10-K 2017-02-28\n",
      "8    105770    WEST PHARMACEUTICAL SERVICES INC      10-K 2018-02-26\n",
      "9    105770    WEST PHARMACEUTICAL SERVICES INC      10-K 2019-02-28\n",
      "10   105770    WEST PHARMACEUTICAL SERVICES INC      10-K 2020-02-24\n",
      "11   105770    WEST PHARMACEUTICAL SERVICES INC      10-K 2021-02-23\n",
      "12   105770    WEST PHARMACEUTICAL SERVICES INC      10-K 2022-02-22\n",
      "13    10795                 BECTON DICKINSON CO      10-K 2017-11-22\n",
      "14    10795                 BECTON DICKINSON CO      10-K 2018-11-21\n",
      "15    10795                 BECTON DICKINSON CO      10-K 2019-11-27\n",
      "16    10795                 BECTON DICKINSON CO      10-K 2020-11-25\n",
      "17    10795                 BECTON DICKINSON CO      10-K 2021-11-24\n",
      "18    10795                 BECTON DICKINSON CO      10-K 2022-11-22\n",
      "19  1138723                         ACCURAY INC      10-K 2017-08-25\n",
      "20  1138723                         ACCURAY INC      10-K 2018-08-24\n",
      "21  1138723                         ACCURAY INC      10-K 2019-08-23\n",
      "22  1138723                         ACCURAY INC      10-K 2020-08-25\n",
      "23  1138723                         ACCURAY INC      10-K 2021-08-17\n",
      "24  1138723                         ACCURAY INC      10-K 2022-08-17\n",
      "25  1145197                        INSULET CORP      10-K 2017-02-28\n",
      "26  1145197                        INSULET CORP      10-K 2018-02-22\n",
      "27  1145197                        INSULET CORP      10-K 2019-02-26\n",
      "28  1145197                        INSULET CORP      10-K 2020-02-26\n",
      "29  1145197                        INSULET CORP      10-K 2021-02-24\n",
      "30  1145197                        INSULET CORP      10-K 2022-02-24\n",
      "31  1162461                          CUTERA INC      10-K 2017-03-15\n",
      "32  1162461                          CUTERA INC      10-K 2018-03-26\n",
      "33  1162461                          CUTERA INC      10-K 2019-03-18\n",
      "34  1162461                          CUTERA INC      10-K 2020-03-16\n",
      "35  1162461                          CUTERA INC      10-K 2021-03-23\n",
      "36  1162461                          CUTERA INC      10-K 2022-03-01\n",
      "37  1237831                  GLOBUS MEDICAL INC      10-K 2017-03-16\n",
      "38  1237831                  GLOBUS MEDICAL INC      10-K 2018-02-22\n",
      "39  1237831                  GLOBUS MEDICAL INC      10-K 2019-02-21\n",
      "40  1237831                  GLOBUS MEDICAL INC      10-K 2020-02-20\n",
      "41  1237831                  GLOBUS MEDICAL INC      10-K 2021-02-17\n",
      "42  1237831                  GLOBUS MEDICAL INC      10-K 2022-02-17\n",
      "43  1253176                       VAPOTHERM INC      10-K 2019-03-22\n",
      "44  1253176                       VAPOTHERM INC      10-K 2020-03-04\n",
      "45  1253176                       VAPOTHERM INC      10-K 2021-02-24\n",
      "46  1253176                       VAPOTHERM INC      10-K 2022-02-24\n",
      "47  1275187                   ANGIODYNAMICS INC      10-K 2017-08-04\n",
      "48  1275187                   ANGIODYNAMICS INC      10-K 2018-07-23\n",
      "49  1275187                   ANGIODYNAMICS INC      10-K 2019-07-25\n",
      "50  1275187                   ANGIODYNAMICS INC      10-K 2020-08-10\n",
      "51  1275187                   ANGIODYNAMICS INC      10-K 2021-07-27\n",
      "52  1275187                   ANGIODYNAMICS INC      10-K 2022-07-22\n",
      "53  1285550              MRI INTERVENTIONS INC       10-K 2017-03-09\n",
      "54  1285550              MRI INTERVENTIONS INC       10-K 2018-03-21\n",
      "55  1285550              MRI INTERVENTIONS INC       10-K 2019-04-01\n",
      "56  1285550               CLEARPOINT NEURO INC       10-K 2020-03-27\n",
      "57  1285550               CLEARPOINT NEURO INC       10-K 2021-03-22\n",
      "58  1285550               CLEARPOINT NEURO INC       10-K 2022-03-09\n",
      "59  1321732                        PENUMBRA INC      10-K 2017-02-28\n",
      "60  1321732                        PENUMBRA INC      10-K 2018-02-27\n",
      "61  1321732                        PENUMBRA INC      10-K 2019-02-26\n",
      "62  1321732                        PENUMBRA INC      10-K 2020-02-26\n",
      "63  1321732                        PENUMBRA INC      10-K 2021-02-23\n",
      "64  1321732                        PENUMBRA INC      10-K 2022-02-22\n",
      "65  1323885                       ATRICURE INC       10-K 2017-03-08\n",
      "66  1323885                       ATRICURE INC       10-K 2018-02-28\n",
      "67  1323885                       ATRICURE INC       10-K 2019-03-01\n",
      "68  1323885                       ATRICURE INC       10-K 2020-02-24\n",
      "69  1323885                       ATRICURE INC       10-K 2021-02-26\n",
      "70  1323885                       ATRICURE INC       10-K 2022-02-17\n",
      "71  1339005                         FEMASYS INC      10-K 2022-03-24\n",
      "72  1388658           IRHYTHM TECHNOLOGIES INC       10-K 2017-03-31\n",
      "73  1388658           IRHYTHM TECHNOLOGIES INC       10-K 2018-03-01\n",
      "74  1388658           IRHYTHM TECHNOLOGIES INC       10-K 2019-03-04\n",
      "75  1388658           IRHYTHM TECHNOLOGIES INC       10-K 2020-03-02\n",
      "76  1388658           IRHYTHM TECHNOLOGIES INC       10-K 2021-02-26\n",
      "77  1388658           IRHYTHM TECHNOLOGIES INC       10-K 2022-02-28\n",
      "78  1407973                        SONENDO INC       10-K 2022-03-23\n",
      "79  1409269           RESTORATION ROBOTICS INC       10-K 2018-03-05\n",
      "80  1409269           RESTORATION ROBOTICS INC       10-K 2019-03-20\n",
      "81  1409269                  VENUS CONCEPT INC       10-K 2020-03-30\n",
      "82  1409269                  VENUS CONCEPT INC       10-K 2021-03-29\n",
      "83  1409269                  VENUS CONCEPT INC       10-K 2022-03-28\n",
      "84  1438133            TANDEM DIABETES CARE INC      10-K 2017-03-08\n",
      "85  1438133            TANDEM DIABETES CARE INC      10-K 2018-03-01\n",
      "86  1438133            TANDEM DIABETES CARE INC      10-K 2019-02-26\n",
      "87  1438133            TANDEM DIABETES CARE INC      10-K 2020-02-24\n",
      "88  1438133            TANDEM DIABETES CARE INC      10-K 2021-02-24\n",
      "89  1438133            TANDEM DIABETES CARE INC      10-K 2022-02-22\n",
      "90  1484612                 OUTSET MEDICAL INC       10-K 2021-03-22\n",
      "91  1484612                 OUTSET MEDICAL INC       10-K 2022-02-23\n",
      "92  1492674                  T2 BIOSYSTEMS INC       10-K 2017-03-15\n",
      "93  1492674                  T2 BIOSYSTEMS INC       10-K 2018-03-19\n",
      "94  1492674                  T2 BIOSYSTEMS INC       10-K 2019-03-14\n",
      "95  1492674                  T2 BIOSYSTEMS INC       10-K 2020-03-16\n",
      "96  1492674                  T2 BIOSYSTEMS INC       10-K 2021-03-31\n",
      "97  1492674                  T2 BIOSYSTEMS INC       10-K 2022-03-23\n",
      "98  1494891              SENSUS HEALTHCARE INC       10-K 2017-03-10\n",
      "99  1494891              SENSUS HEALTHCARE INC       10-K 2018-02-15\n",
      "100 1494891              SENSUS HEALTHCARE INC       10-K 2019-03-15\n",
      "101 1494891              SENSUS HEALTHCARE INC       10-K 2020-03-06\n",
      "102 1494891              SENSUS HEALTHCARE INC       10-K 2021-03-05\n",
      "103 1494891              SENSUS HEALTHCARE INC       10-K 2022-03-25\n",
      "104 1501134                        INVITAE CORP      10-K 2017-03-16\n",
      "105 1501134                        INVITAE CORP      10-K 2018-03-06\n",
      "106 1501134                        INVITAE CORP      10-K 2019-02-28\n",
      "107 1501134                        INVITAE CORP      10-K 2020-03-02\n",
      "108 1501134                        INVITAE CORP      10-K 2021-02-26\n",
      "109 1501134                        INVITAE CORP      10-K 2022-03-01\n",
      "110 1512138         GREAT BASIN SCIENTIFIC INC       10-K 2017-03-22\n",
      "111 1522860                 ACUTUS MEDICAL INC       10-K 2021-03-19\n",
      "112 1522860                 ACUTUS MEDICAL INC       10-K 2022-03-30\n",
      "113 1531048                  INARI MEDICAL INC       10-K 2021-03-09\n",
      "114 1531048                  INARI MEDICAL INC       10-K 2022-02-23\n",
      "115 1531978                     PARAGON 28 INC       10-K 2022-03-08\n",
      "116 1566469                     NANTHEALTH INC       10-K 2017-03-31\n",
      "117 1566469                     NANTHEALTH INC       10-K 2018-03-16\n",
      "118 1566469                     NANTHEALTH INC       10-K 2019-04-01\n",
      "119 1566469                     NANTHEALTH INC       10-K 2020-02-28\n",
      "120 1566469                     NANTHEALTH INC       10-K 2021-02-26\n",
      "121 1566469                     NANTHEALTH INC       10-K 2022-02-25\n",
      "122 1588978            PROCEPT BIOROBOTICS CORP      10-K 2022-03-22\n",
      "123 1607962                REWALK ROBOTICS LTD       10-K 2017-02-17\n",
      "124 1607962                REWALK ROBOTICS LTD       10-K 2018-03-08\n",
      "125 1607962                REWALK ROBOTICS LTD       10-K 2019-02-08\n",
      "126 1607962                REWALK ROBOTICS LTD       10-K 2020-02-20\n",
      "127 1607962                REWALK ROBOTICS LTD       10-K 2021-02-18\n",
      "128 1607962                REWALK ROBOTICS LTD       10-K 2022-02-24\n",
      "129 1625101              PULSE BIOSCIENCES INC       10-K 2017-03-20\n",
      "130 1625101              PULSE BIOSCIENCES INC       10-K 2018-03-16\n",
      "131 1625101              PULSE BIOSCIENCES INC       10-K 2019-03-14\n",
      "132 1625101              PULSE BIOSCIENCES INC       10-K 2020-03-16\n",
      "133 1625101              PULSE BIOSCIENCES INC       10-K 2021-03-12\n",
      "134 1625101              PULSE BIOSCIENCES INC       10-K 2022-03-31\n",
      "135 1628945                     CUE HEALTH INC       10-K 2022-03-29\n",
      "136 1630627        TREACE MEDICAL CONCEPTS INC       10-K 2022-03-04\n",
      "137 1640266           VOYAGER THERAPEUTICS INC       10-K 2017-03-15\n",
      "138 1640266           VOYAGER THERAPEUTICS INC       10-K 2018-03-14\n",
      "139 1640266           VOYAGER THERAPEUTICS INC       10-K 2019-02-26\n",
      "140 1640266           VOYAGER THERAPEUTICS INC       10-K 2020-03-03\n",
      "141 1640266           VOYAGER THERAPEUTICS INC       10-K 2021-02-25\n",
      "142 1640266           VOYAGER THERAPEUTICS INC       10-K 2022-03-08\n",
      "143 1642545              SHOCKWAVE MEDICAL INC       10-K 2020-03-12\n",
      "144 1642545              SHOCKWAVE MEDICAL INC       10-K 2021-02-26\n",
      "145 1642545              SHOCKWAVE MEDICAL INC       10-K 2022-02-25\n",
      "146 1668243                  UROGEN PHARMA LTD       10-K 2019-02-28\n",
      "147 1668243                  UROGEN PHARMA LTD       10-K 2020-03-02\n",
      "148 1668243                  UROGEN PHARMA LTD       10-K 2021-03-18\n",
      "149 1668243                  UROGEN PHARMA LTD       10-K 2022-03-21\n",
      "150 1716166             VIVOS THERAPEUTICS INC       10-K 2021-03-25\n",
      "151 1716166             VIVOS THERAPEUTICS INC       10-K 2022-03-31\n",
      "152 1716621             RA MEDICAL SYSTEMS INC       10-K 2019-03-15\n",
      "153 1716621             RA MEDICAL SYSTEMS INC       10-K 2020-03-11\n",
      "154 1716621             RA MEDICAL SYSTEMS INC       10-K 2021-03-17\n",
      "155 1716621             RA MEDICAL SYSTEMS INC       10-K 2022-03-24\n",
      "156 1719395                          EARGO INC       10-K 2021-03-16\n",
      "157 1719395                          EARGO INC       10-K 2022-05-13\n",
      "158    1800                 ABBOTT LABORATORIES      10-K 2017-02-17\n",
      "159    1800                 ABBOTT LABORATORIES      10-K 2018-02-16\n",
      "160    1800                 ABBOTT LABORATORIES      10-K 2019-02-22\n",
      "161    1800                 ABBOTT LABORATORIES      10-K 2020-02-21\n",
      "162    1800                 ABBOTT LABORATORIES      10-K 2021-02-19\n",
      "163    1800                 ABBOTT LABORATORIES      10-K 2022-02-18\n",
      "164 1804176              BUTTERFLY NETWORK INC       10-K 2021-03-29\n",
      "165 1804176              BUTTERFLY NETWORK INC       10-K 2022-02-28\n",
      "166 1833769 HEALTHCOR CATALIO ACQUISITION CORP       10-K 2021-03-29\n",
      "167 1833769                      HYPERFINE INC       10-K 2022-03-25\n",
      "168 1835567              PEAR THERAPEUTICS INC       10-K 2022-03-29\n",
      "169  313143                    HAEMONETICS CORP      10-K 2017-05-24\n",
      "170  313143                    HAEMONETICS CORP      10-K 2018-05-23\n",
      "171  313143                    HAEMONETICS CORP      10-K 2019-05-22\n",
      "172  313143                    HAEMONETICS CORP      10-K 2020-05-20\n",
      "173  313143                    HAEMONETICS CORP      10-K 2021-05-26\n",
      "174  313143                    HAEMONETICS CORP      10-K 2022-05-25\n",
      "175  320193                           APPLE INC      10-K 2017-11-03\n",
      "176  320193                           APPLE INC      10-K 2018-11-05\n",
      "177  320193                          APPLE INC       10-K 2019-10-31\n",
      "178  320193                          APPLE INC       10-K 2020-10-30\n",
      "179  320193                          APPLE INC       10-K 2021-10-29\n",
      "180  320193                          APPLE INC       10-K 2022-10-28\n",
      "181   66740                               3M CO      10-K 2017-02-09\n",
      "182   66740                               3M CO      10-K 2018-02-08\n",
      "183   66740                               3M CO      10-K 2019-02-07\n",
      "184   66740                               3M CO      10-K 2020-02-06\n",
      "185   66740                               3M CO      10-K 2021-02-04\n",
      "186   66740                               3M CO      10-K 2022-02-09\n",
      "187  721371                 CARDINAL HEALTH INC      10-K 2017-08-10\n",
      "188  721371                 CARDINAL HEALTH INC      10-K 2018-08-22\n",
      "189  721371                 CARDINAL HEALTH INC      10-K 2019-08-20\n",
      "190  721371                 CARDINAL HEALTH INC      10-K 2020-08-13\n",
      "191  721371                 CARDINAL HEALTH INC      10-K 2021-08-16\n",
      "192  721371                 CARDINAL HEALTH INC      10-K 2022-08-11\n",
      "193  794172             MERIDIAN BIOSCIENCE INC      10-K 2017-11-29\n",
      "194  794172             MERIDIAN BIOSCIENCE INC      10-K 2018-11-29\n",
      "195  794172             MERIDIAN BIOSCIENCE INC      10-K 2019-11-26\n",
      "196  794172             MERIDIAN BIOSCIENCE INC      10-K 2020-11-23\n",
      "197  794172             MERIDIAN BIOSCIENCE INC      10-K 2021-11-23\n",
      "198  794172             MERIDIAN BIOSCIENCE INC      10-K 2022-11-22\n",
      "199    8818                 AVERY DENNISON CORP      10-K 2017-02-23\n",
      "200    8818                 AVERY DENNISON CORP      10-K 2018-02-21\n",
      "201    8818                 AVERY DENNISON CORP      10-K 2019-02-27\n",
      "202    8818                 AVERY DENNISON CORP      10-K 2020-02-26\n",
      "203    8818                 AVERY DENNISON CORP      10-K 2021-02-25\n",
      "204    8818                 AVERY DENNISON CORP      10-K 2022-02-23\n",
      "205  885725              BOSTON SCIENTIFIC CORP      10-K 2017-02-23\n",
      "206  885725              BOSTON SCIENTIFIC CORP      10-K 2018-02-20\n",
      "207  885725              BOSTON SCIENTIFIC CORP      10-K 2019-02-19\n",
      "208  885725              BOSTON SCIENTIFIC CORP      10-K 2020-02-25\n",
      "209  885725              BOSTON SCIENTIFIC CORP      10-K 2021-02-23\n",
      "210  885725              BOSTON SCIENTIFIC CORP      10-K 2022-02-23\n",
      "211  898437             ANIKA THERAPEUTICS INC       10-K 2017-02-24\n",
      "212  898437             ANIKA THERAPEUTICS INC       10-K 2018-02-27\n",
      "213  898437             ANIKA THERAPEUTICS INC       10-K 2019-02-27\n",
      "214  898437             ANIKA THERAPEUTICS INC       10-K 2020-03-06\n",
      "215  898437             ANIKA THERAPEUTICS INC       10-K 2021-03-05\n",
      "216  898437             ANIKA THERAPEUTICS INC       10-K 2022-03-11\n",
      "217  913165                        EXACTECH INC      10-K 2017-03-08\n",
      "218  924717                       SURMODICS INC      10-K 2017-12-01\n",
      "219  924717                       SURMODICS INC      10-K 2018-11-30\n",
      "220  924717                       SURMODICS INC      10-K 2019-12-03\n",
      "221  924717                       SURMODICS INC      10-K 2020-12-02\n",
      "222  924717                       SURMODICS INC      10-K 2021-11-24\n",
      "223  924717                       SURMODICS INC      10-K 2022-11-23\n",
      "        accession.number    downld.status extract.status\n",
      "1   0001035267-17-000021 Download success              1\n",
      "2   0001035267-18-000013 Download success              1\n",
      "3   0001035267-19-000012 Download success              1\n",
      "4   0001035267-20-000032 Download success              0\n",
      "5   0001035267-21-000028 Download success              0\n",
      "6   0001035267-22-000014 Download success              0\n",
      "7   0000105770-17-000011 Download success              1\n",
      "8   0000105770-18-000006 Download success              1\n",
      "9   0000105770-19-000012 Download success              1\n",
      "10  0000105770-20-000015 Download success              0\n",
      "11  0000105770-21-000008 Download success              0\n",
      "12  0001628280-22-003342 Download success              0\n",
      "13  0000010795-17-000021 Download success              1\n",
      "14  0000010795-18-000036 Download success              1\n",
      "15  0000010795-19-000044 Download success              1\n",
      "16  0000010795-20-000055 Download success              1\n",
      "17  0000010795-21-000091 Download success              0\n",
      "18  0001628280-22-030686 Download success              0\n",
      "19  0001047469-17-005403 Download success              1\n",
      "20  0001564590-18-022303 Download success              1\n",
      "21  0001564590-19-032909 Download success              1\n",
      "22  0001564590-20-041201 Download success              0\n",
      "23  0001564590-21-044920 Download success              0\n",
      "24  0000950170-22-017550 Download success              0\n",
      "25  0001145197-17-000005 Download success              1\n",
      "26  0001145197-18-000004 Download success              1\n",
      "27  0001145197-19-000003 Download success              1\n",
      "28  0001145197-20-000004 Download success              1\n",
      "29  0001145197-21-000009 Download success              1\n",
      "30  0001145197-22-000012 Download success              1\n",
      "31  0001437749-17-004609 Download success              1\n",
      "32  0001437749-18-005473 Download success              0\n",
      "33  0001437749-19-005203 Download success              1\n",
      "34  0001437749-20-005342 Download success              0\n",
      "35  0001437749-21-006866 Download success              0\n",
      "36  0001628280-22-004539 Download success              0\n",
      "37  0001237831-17-000009 Download success              1\n",
      "38  0001237831-18-000012 Download success              1\n",
      "39  0001237831-19-000014 Download success              1\n",
      "40  0001237831-20-000010 Download success              1\n",
      "41  0001562762-21-000036 Download success              1\n",
      "42  0001562762-22-000037 Download success              1\n",
      "43  0001564590-19-009008 Download success              1\n",
      "44  0001564590-20-008683 Download success              1\n",
      "45  0001564590-21-008100 Download success              0\n",
      "46  0001564590-22-006714 Download success              0\n",
      "47  0001275187-17-000026 Download success              1\n",
      "48  0001275187-18-000011 Download success              1\n",
      "49  0001275187-19-000017 Download success              1\n",
      "50  0001275187-20-000024 Download success              0\n",
      "51  0001275187-21-000013 Download success              0\n",
      "52  0001275187-22-000017 Download success              0\n",
      "53  0001534424-17-000093 Download success              1\n",
      "54  0001534424-18-000090 Download success              1\n",
      "55  0001534424-19-000092 Download success              1\n",
      "56  0001171520-20-000159 Download success              1\n",
      "57  0001171520-21-000138 Download success              1\n",
      "58  0001285550-22-000003 Download success              0\n",
      "59  0001321732-17-000084 Download success              1\n",
      "60  0001321732-18-000038 Download success              1\n",
      "61  0001321732-19-000031 Download success              1\n",
      "62  0001321732-20-000047 Download success              0\n",
      "63  0001628280-21-002867 Download success              0\n",
      "64  0001321732-22-000017 Download success              0\n",
      "65  0001323885-17-000017 Download success              0\n",
      "66  0001323885-18-000017 Download success              0\n",
      "67  0001323885-19-000009 Download success              0\n",
      "68  0001323885-20-000009 Download success              0\n",
      "69  0001323885-21-000011 Download success              0\n",
      "70  0001323885-22-000011 Download success              1\n",
      "71  0001140361-22-011032 Download success              1\n",
      "72  0001564590-17-005767 Download success              1\n",
      "73  0001564590-18-004080 Download success              1\n",
      "74  0001564590-19-005924 Download success              1\n",
      "75  0001388658-20-000034 Download success              0\n",
      "76  0001388658-21-000039 Download success              0\n",
      "77  0001388658-22-000020 Download success              0\n",
      "78  0000950170-22-004418 Download success              0\n",
      "79  0001564590-18-004378 Download success              1\n",
      "80  0001564590-19-008643 Download success              1\n",
      "81  0001564590-20-014222 Download success              1\n",
      "82  0001564590-21-016142 Download success              1\n",
      "83  0001437749-22-007293 Download success              1\n",
      "84  0001564590-17-003680 Download success              1\n",
      "85  0001564590-18-004141 Download success              1\n",
      "86  0001564590-19-004469 Download success              1\n",
      "87  0001438133-20-000014 Download success              1\n",
      "88  0001438133-21-000015 Download success              0\n",
      "89  0001438133-22-000021 Download success              0\n",
      "90  0001564590-21-014563 Download success              1\n",
      "91  0000950170-22-001769 Download success              0\n",
      "92  0001558370-17-001853 Download success              0\n",
      "93  0001564590-18-006225 Download success              0\n",
      "94  0001564590-19-007862 Download success              0\n",
      "95  0001564590-20-011217 Download success              0\n",
      "96  0001564590-21-017074 Download success              0\n",
      "97  0001564590-22-011526 Download success              0\n",
      "98  0001615774-17-000965 Download success              1\n",
      "99  0001615774-18-001252 Download success              1\n",
      "100 0001615774-19-004125 Download success              1\n",
      "101 0001213900-20-005609 Download success              1\n",
      "102 0001213900-21-013664 Download success              1\n",
      "103 0001213900-22-015172 Download success              0\n",
      "104 0001564590-17-004633 Download success              1\n",
      "105 0001564590-18-004430 Download success              1\n",
      "106 0001501134-19-000022 Download success              1\n",
      "107 0001501134-20-000013 Download success              1\n",
      "108 0001501134-21-000012 Download success              0\n",
      "109 0001501134-22-000008 Download success              0\n",
      "110 0001564590-17-004956 Download success              1\n",
      "111 0001564590-21-014208 Download success              1\n",
      "112 0001628280-22-007921 Download success              0\n",
      "113 0001564590-21-011763 Download success              1\n",
      "114 0000950170-22-001783 Download success              0\n",
      "115 0000950170-22-003129 Download success              0\n",
      "116 0001566469-17-000007 Download success              1\n",
      "117 0001566469-18-000006 Download success              1\n",
      "118 0001566469-19-000012 Download success              1\n",
      "119 0001566469-20-000015 Download success              1\n",
      "120 0001566469-21-000010 Download success              0\n",
      "121 0001566469-22-000013 Download success              0\n",
      "122 0001628280-22-006885 Download success              0\n",
      "123 0001607962-17-000006 Download success              1\n",
      "124 0001607962-18-000007 Download success              1\n",
      "125 0001213900-19-001871 Download success              1\n",
      "126 0001213900-20-004363 Download success              1\n",
      "127 0001178913-21-000678 Download success              1\n",
      "128 0001178913-22-000800 Download success              0\n",
      "129 0001625101-17-000011 Download success              1\n",
      "130 0001625101-18-000012 Download success              1\n",
      "131 0001625101-19-000008 Download success              1\n",
      "132 0001625101-20-000011 Download success              1\n",
      "133 0001625101-21-000014 Download success              1\n",
      "134 0001625101-22-000016 Download success              1\n",
      "135 0001628945-22-000031 Download success              0\n",
      "136 0000950170-22-002903 Download success              0\n",
      "137 0001558370-17-001797 Download success              1\n",
      "138 0001558370-18-002038 Download success              1\n",
      "139 0001558370-19-001105 Download success              1\n",
      "140 0001558370-20-001974 Download success              0\n",
      "141 0001558370-21-001865 Download success              1\n",
      "142 0001558370-22-003015 Download success              1\n",
      "143 0001564590-20-010523 Download success              1\n",
      "144 0001564590-21-009415 Download success              1\n",
      "145 0001564590-22-007162 Download success              0\n",
      "146 0001564590-19-005323 Download success              1\n",
      "147 0001564590-20-007970 Download success              0\n",
      "148 0001564590-21-014016 Download success              0\n",
      "149 0001437749-22-006778 Download success              1\n",
      "150 0001493152-21-006806 Download success              1\n",
      "151 0001493152-22-008452 Download success              0\n",
      "152 0001564590-19-007905 Download success              1\n",
      "153 0001564590-20-010123 Download success              1\n",
      "154 0001564590-21-013653 Download success              1\n",
      "155 0001564590-22-011555 Download success              0\n",
      "156 0001564590-21-013613 Download success              1\n",
      "157 0001193125-22-150135 Download success              1\n",
      "158 0001047469-17-000744 Download success              1\n",
      "159 0001047469-18-000856 Download success              1\n",
      "160 0001047469-19-000624 Download success              1\n",
      "161 0001104659-20-023904 Download success              0\n",
      "162 0001104659-21-025751 Download success              1\n",
      "163 0001104659-22-025141 Download success              1\n",
      "164 0001104659-21-043278 Download success              1\n",
      "165 0001558370-22-002397 Download success              1\n",
      "166 0001104659-21-042599 Download success              1\n",
      "167 0000950170-22-004670 Download success              0\n",
      "168 0001835567-22-000010 Download success              0\n",
      "169 0000313143-17-000017 Download success              1\n",
      "170 0000313143-18-000020 Download success              1\n",
      "171 0000313143-19-000022 Download success              1\n",
      "172 0000313143-20-000028 Download success              1\n",
      "173 0000313143-21-000023 Download success              1\n",
      "174 0000313143-22-000024 Download success              1\n",
      "175 0000320193-17-000070 Download success              1\n",
      "176 0000320193-18-000145 Download success              1\n",
      "177 0000320193-19-000119 Download success              0\n",
      "178 0000320193-20-000096 Download success              0\n",
      "179 0000320193-21-000105 Download success              0\n",
      "180 0000320193-22-000108 Download success              0\n",
      "181 0001558370-17-000479 Download success              0\n",
      "182 0001558370-18-000535 Download success              0\n",
      "183 0001558370-19-000470 Download success              0\n",
      "184 0001558370-20-000581 Download success              0\n",
      "185 0001558370-21-000737 Download success              0\n",
      "186 0000066740-22-000010 Download success              0\n",
      "187 0000721371-17-000083 Download success              0\n",
      "188 0000721371-18-000077 Download success              0\n",
      "189 0000721371-19-000090 Download success              0\n",
      "190 0000721371-20-000089 Download success              0\n",
      "191 0000721371-21-000080 Download success              0\n",
      "192 0000721371-22-000058 Download success              0\n",
      "193 0001193125-17-354808 Download success              1\n",
      "194 0001193125-18-337257 Download success              1\n",
      "195 0001193125-19-300565 Download success              1\n",
      "196 0001193125-20-300813 Download success              1\n",
      "197 0001193125-21-337663 Download success              1\n",
      "198 0001193125-22-290521 Download success              1\n",
      "199 0001047469-17-000881 Download success              1\n",
      "200 0001047469-18-000931 Download success              1\n",
      "201 0001047469-19-000747 Download success              1\n",
      "202 0001104659-20-025360 Download success              0\n",
      "203 0001193125-21-055146 Download success              1\n",
      "204 0001193125-22-049910 Download success              1\n",
      "205 0000885725-17-000006 Download success              1\n",
      "206 0000885725-18-000010 Download success              1\n",
      "207 0000885725-19-000011 Download success              1\n",
      "208 0000885725-20-000012 Download success              0\n",
      "209 0000885725-21-000008 Download success              0\n",
      "210 0000885725-22-000006 Download success              0\n",
      "211 0001171843-17-001121 Download success              1\n",
      "212 0001171843-18-001450 Download success              1\n",
      "213 0001171843-19-001243 Download success              1\n",
      "214 0001171843-20-001536 Download success              1\n",
      "215 0001171843-21-001573 Download success              1\n",
      "216 0001171843-22-001790 Download success              1\n",
      "217 0000913165-17-000006 Download success              1\n",
      "218 0001564590-17-024465 Download success              1\n",
      "219 0001564590-18-030336 Download success              1\n",
      "220 0001564590-19-045173 Download success              1\n",
      "221 0001564590-20-055870 Download success              0\n",
      "222 0001564590-21-058206 Download success              0\n",
      "223 0000950170-22-025644 Download success              0\n"
     ]
    }
   ],
   "source": [
    "%%R -i r_CIKS\n",
    "library(tidyverse)\n",
    "library(dplyr)\n",
    "library(edgar)\n",
    "\n",
    "print(r_CIKS)\n",
    "getBusinDescr(cik.no= r_CIKS, filing.year = c(2017,2018,2019,2020,2021,2022),useragent = \"bed35@georgetown.edu\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[1] cik          company_href company_name\n",
      "<0 rows> (or 0-length row.names)\n"
     ]
    }
   ],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "base",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.13"
  },
  "orig_nbformat": 4
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
